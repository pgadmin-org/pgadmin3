<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>E.35. Release 8.0</title>
<link rel="stylesheet" href="stylesheet.css" type="text/css">
<link rev="made" href="pgsql-docs@postgresql.org">
<meta name="generator" content="DocBook XSL Stylesheets V1.73.2">
<link rel="start" href="index.html" title="PostgreSQL 8.2.6 Documentation">
<link rel="up" href="release.html" title="Appendix E. Release Notes">
<link rel="prev" href="release-8-0-1.html" title="E.34. Release 8.0.1">
<link rel="next" href="release-7-4-19.html" title="E.36. Release 7.4.19">
<link rel="copyright" href="ln-legalnotice.html" title="Legal Notice">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect1" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both" id="release-8-0">E.35. Release 8.0</h2></div></div></div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Release date</h3>
<p>2005-01-19</p>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title" id="id2890335">E.35.1. Overview</h3></div></div></div>
<p>    Major changes in this release:
   </p>
<div class="variablelist"><dl>
<dt><span class="term">      Microsoft Windows Native Server
     </span></dt>
<dd>
<p>       This is the first <span class="productname">PostgreSQL</span> release
       to run natively on <span class="trademark">Microsoft Windows</span>® as
       a server. It can run as a <span class="productname">Windows</span> service. This
       release supports NT-based Windows releases like
       <span class="productname">Windows 2000 SP4</span>, <span class="productname">Windows XP</span>, and
       <span class="productname">Windows 2003</span>. Older releases like
       <span class="productname">Windows 95</span>, <span class="productname">Windows 98</span>, and
       <span class="productname">Windows ME</span> are not supported because these operating
       systems do not have the infrastructure to support
       <span class="productname">PostgreSQL</span>. A separate installer
       project has been created to ease installation on
       <span class="productname">Windows</span> &#8212; see <a class="ulink" href="http://www.postgresql.org/ftp/win32/" target="_top">http://www.postgresql.org/ftp/win32/</a>.
      </p>
<p>       Although tested throughout our release cycle, the Windows port
       does not have the benefit of years of use in production
       environments that <span class="productname">PostgreSQL</span> has on
       Unix platforms.  Therefore it should be treated with the same
       level of caution as you would a new product.
      </p>
<p>       Previous releases required the Unix emulation toolkit
       <span class="productname">Cygwin</span> in order to run the server on Windows
       operating systems.  <span class="productname">PostgreSQL</span> has
       supported native clients on Windows for many years.
      </p>
</dd>
<dt><span class="term">      Savepoints
     </span></dt>
<dd><p>       Savepoints allow specific parts of a transaction to be aborted
       without affecting the remainder of the transaction. Prior
       releases had no such capability; there was no way to recover
       from a statement failure within a transaction except by
       aborting the whole transaction. This feature is valuable for
       application writers who require error recovery within a
       complex transaction.
      </p></dd>
<dt><span class="term">      Point-In-Time Recovery
     </span></dt>
<dd><p>       In previous releases there was no way to recover from disk
       drive failure except to restore from a previous backup or use
       a standby replication server.  Point-in-time recovery allows
       continuous backup of the server.  You can recover either to
       the point of failure or to some transaction in the past.
      </p></dd>
<dt><span class="term">      Tablespaces
     </span></dt>
<dd><p>       Tablespaces allow administrators to select different file systems
       for storage of individual tables, indexes, and databases.
       This improves performance and control over disk space
       usage. Prior releases used <span class="application">initlocation</span> and
       manual symlink management for such tasks.
      </p></dd>
<dt><span class="term">      Improved Buffer Management, <code class="command">CHECKPOINT</code>,
      <code class="command">VACUUM</code>
     </span></dt>
<dd><p>       This release has a more intelligent buffer replacement strategy,
       which will make better use of available shared buffers and
       improve performance. The performance impact of vacuum and
       checkpoints is also lessened.
      </p></dd>
<dt><span class="term">      Change Column Types
     </span></dt>
<dd><p>       A column's data type can now be changed with <code class="command">ALTER
       TABLE</code>.
      </p></dd>
<dt><span class="term">      New Perl Server-Side Language
     </span></dt>
<dd><p>       A new version of the <span class="application">plperl</span> server-side language now
       supports a persistent shared storage area, triggers, returning records
       and arrays of records, and SPI calls to access the database.
      </p></dd>
<dt><span class="term">       Comma-separated-value (CSV) support in <code class="command">COPY</code>
     </span></dt>
<dd><p>       <code class="command">COPY</code> can now read and write
       comma-separated-value files. It has the flexibility to
       interpret nonstandard quoting and separation characters too.
      </p></dd>
</dl></div>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title" id="id2890578">E.35.2. Migration to Version 8.0</h3></div></div></div>
<p>    A dump/restore using <span class="application">pg_dump</span> is
    required for those wishing to migrate data from any previous
    release.
   </p>
<p>    Observe the following incompatibilities:
   </p>
<div class="itemizedlist"><ul type="disc">
<li><p>      In <code class="option">READ COMMITTED</code> serialization mode, volatile functions
      now see the results of concurrent transactions committed up to the
      beginning of each statement within the function, rather than up to the
      beginning of the interactive command that called the function.
     </p></li>
<li><p>      Functions declared <code class="option">STABLE</code> or <code class="option">IMMUTABLE</code> always
      use the snapshot of the calling query, and therefore do not see the
      effects of actions taken after the calling query starts, whether in
      their own transaction or other transactions.  Such a function must be
      read-only, too, meaning that it cannot use any SQL commands other than
      <code class="command">SELECT</code>.
     </p></li>
<li><p>      Nondeferred <code class="option">AFTER</code> triggers are now fired immediately
      after completion of the triggering query, rather than upon
      finishing the current interactive command. This makes a
      difference when the triggering query occurred within a function:
      the trigger is invoked before the function proceeds to its next
      operation.
     </p></li>
<li><p>      Server configuration parameters <code class="varname">virtual_host</code> and
      <code class="varname">tcpip_socket</code> have been replaced with a more general
      parameter <code class="varname">listen_addresses</code>. Also, the server now listens on
      <code class="literal">localhost</code> by default, which eliminates the need for the
      <code class="literal">-i</code> postmaster switch in many scenarios.
     </p></li>
<li><p>      Server configuration parameters <code class="varname">SortMem</code> and
      <code class="varname">VacuumMem</code> have been renamed to <code class="varname">work_mem</code>
      and <code class="varname">maintenance_work_mem</code> to better reflect their
      use. The original names are still supported in
      <code class="command">SET</code> and <code class="command">SHOW</code>.
     </p></li>
<li><p>      Server configuration parameters <code class="varname">log_pid</code>,
      <code class="varname">log_timestamp</code>, and <code class="varname">log_source_port</code> have been
      replaced with a more general parameter <code class="varname">log_line_prefix</code>.
     </p></li>
<li><p>      Server configuration parameter <code class="varname">syslog</code> has been
      replaced with a more logical <code class="varname">log_destination</code> variable to
      control the log output destination.
     </p></li>
<li><p>      Server configuration parameter <code class="varname">log_statement</code> has been
      changed so it can selectively log just database modification or
      data definition statements.  Server configuration parameter
      <code class="varname">log_duration</code> now prints only when <code class="varname">log_statement</code>
      prints the query.
     </p></li>
<li><p>      Server configuration parameter <code class="varname">max_expr_depth</code> parameter has
      been replaced with <code class="varname">max_stack_depth</code> which measures the
      physical stack size rather than the expression nesting depth. This
      helps prevent session termination due to stack overflow caused by
      recursive functions.
     </p></li>
<li><p>      The <code class="function">length()</code> function no longer counts trailing spaces in
      <code class="type">CHAR(n)</code> values.
     </p></li>
<li><p>     Casting an integer to <code class="type">BIT(N)</code> selects the rightmost N bits of the
     integer, not the leftmost N bits as before.
    </p></li>
<li><p>     Updating an element or slice of a NULL array value now produces
     a nonnull array result, namely an array containing
     just the assigned-to positions.
    </p></li>
<li><p>      Syntax checking of array input values has been tightened up
      considerably. Junk that was previously allowed in odd places with
      odd results now causes an error. Empty-string element values
      must now be written as <code class="literal">""</code>, rather than writing nothing.
      Also changed behavior with respect to whitespace surrounding
      array elements: trailing whitespace is now ignored, for symmetry
      with leading whitespace (which has always been ignored).
     </p></li>
<li><p>      Overflow in integer arithmetic operations is now detected and
      reported as an error.
     </p></li>
<li><p>      The arithmetic operators associated with the single-byte
      <code class="type">"char"</code> data type have been removed.
     </p></li>
<li><p>      The <code class="function">extract()</code> function (also called
      <code class="function">date_part</code>) now returns the proper year for BC dates.
      It previously returned one less than the correct year. The
      function now also returns the proper values for millennium and
      century.
     </p></li>
<li><p>     <code class="type">CIDR</code> values now must have their nonmasked bits be zero.
     For example, we no longer allow
     <code class="literal">204.248.199.1/31</code> as a <code class="type">CIDR</code> value. Such
     values should never have been accepted by
     <span class="productname">PostgreSQL</span> and will now be rejected.
    </p></li>
<li><p>      <code class="command">EXECUTE</code> now returns a completion tag that
      matches the executed statement.
     </p></li>
<li><p>      <span class="application">psql</span>'s <code class="command">\copy</code> command now reads or
      writes to the query's <code class="literal">stdin/stdout</code>, rather than
      <span class="application">psql</span>'s <code class="literal">stdin/stdout</code>. The previous
      behavior can be accessed via new
      <code class="option">pstdin</code>/<code class="option">pstdout</code> parameters.
     </p></li>
<li><p>     The JDBC client interface has been removed from the core
     distribution, and is now hosted at <a class="ulink" href="http://jdbc.postgresql.org" target="_top">http://jdbc.postgresql.org</a>.
     </p></li>
<li><p>     The Tcl client interface has also been removed. There are several
     Tcl interfaces now hosted at <a class="ulink" href="http://gborg.postgresql.org" target="_top">http://gborg.postgresql.org</a>.
     </p></li>
<li><p>      The server now uses its own time zone database, rather than the
      one supplied by the operating system. This will provide consistent
      behavior across all platforms.  In most cases, there should be
      little noticeable difference in time zone behavior, except that
      the time zone names used by <code class="command">SET</code>/<code class="command">SHOW</code>
      <code class="varname">TimeZone</code> might be different from what your platform provides.
     </p></li>
<li><p>      <span class="application">Configure</span>'s threading option no longer requires
      users to run tests or edit configuration files; threading options
      are now detected automatically.
     </p></li>
<li><p>      Now that tablespaces have been implemented,
      <span class="application">initlocation</span> has been removed.
     </p></li>
<li><p>      The API for user-defined GiST indexes has been changed. The
      Union and PickSplit methods are now passed a pointer to a
      special <code class="structname">GistEntryVector</code> structure,
      rather than a <code class="type">bytea</code>.
     </p></li>
</ul></div>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title" id="id2891010">E.35.3. Deprecated Features</h3></div></div></div>
<p>    Some aspects of <span class="productname">PostgreSQL</span>'s behavior
    have been determined to be suboptimal. For the sake of backward
    compatibility these have not been removed in 8.0, but they are
    considered deprecated and will be removed in the next major
    release.
    </p>
<div class="itemizedlist"><ul type="disc">
<li><p>      The 8.1 release will remove the <code class="function">to_char()</code> function
      for intervals.
     </p></li>
<li><p>       The server now warns of empty strings passed to
       <code class="type">oid</code>/<code class="type">float4</code>/<code class="type">float8</code> data
       types, but continues to interpret them as zeroes as before.
       In the next major release, empty strings will be considered
       invalid input for these data types.
      </p></li>
<li><p>      By default, tables in <span class="productname">PostgreSQL</span> 8.0
      and earlier are created with <code class="type">OID</code>s. In the next release,
      this will <span class="emphasis"><em>not</em></span> be the case: to create a table
      that contains <code class="type">OID</code>s, the <code class="option">WITH OIDS</code> clause must
      be specified or the <code class="varname">default_with_oids</code>
      configuration parameter must be set. Users are encouraged to
      explicitly specify <code class="option">WITH OIDS</code> if their tables
      require OIDs for compatibility with future releases of
      <span class="productname">PostgreSQL</span>.
     </p></li>
</ul></div>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title" id="id2891098">E.35.4. Changes</h3></div></div></div>
<p>    Below you will find a detailed account of the changes between
    release 8.0 and the previous major release.
   </p>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2891106">E.35.4.1. Performance Improvements</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>       Support cross-data-type index usage (Tom)
      </p>
<p>       Before this change, many queries would not use an index if the data
       types did not match exactly. This improvement makes index usage more
       intuitive and consistent.
      </p>
</li>
<li>
<p>       New buffer replacement strategy that improves caching (Jan)
      </p>
<p>       Prior releases used a least-recently-used (LRU) cache to keep
       recently referenced pages in memory. The LRU algorithm
       did not consider the number of times a specific cache entry was
       accessed, so large table scans could force out useful cache pages.
       The new cache algorithm uses four separate lists to track most
       recently used and most frequently used cache pages and dynamically
       optimize their replacement based on the work load. This should
       lead to much more efficient use of the shared buffer cache.
       Administrators who have tested shared buffer sizes in the past
       should retest with this new cache replacement policy.
      </p>
</li>
<li>
<p>       Add subprocess to write dirty buffers periodically to reduce
       checkpoint writes (Jan)
      </p>
<p>       In previous releases, the checkpoint process, which runs every few
       minutes, would write all dirty buffers to the operating system's
       buffer cache then flush all dirty operating system buffers to
       disk. This resulted in a periodic spike in disk usage that often
       hurt performance. The new code uses a background writer to trickle
       disk writes at a steady pace so checkpoints have far fewer dirty
       pages to write to disk. Also, the new code does not issue a global
       <code class="function">sync()</code> call, but instead <code class="function">fsync()</code>s just
       the files written since the last checkpoint. This should improve
       performance and minimize degradation during checkpoints.
      </p>
</li>
<li>
<p>       Add ability to prolong vacuum to reduce performance impact (Jan)
      </p>
<p>       On busy systems, <code class="command">VACUUM</code> performs many I/O
       requests which can hurt performance for other users. This
       release allows you to slow down <code class="command">VACUUM</code> to
       reduce its impact on other users, though this increases the
       total duration of <code class="command">VACUUM</code>.
      </p>
</li>
<li>
<p>       Improve B-tree index performance for duplicate keys (Dmitry Tkach, Tom)
      </p>
<p>       This improves the way indexes are scanned when many duplicate
       values exist in the index.
      </p>
</li>
<li>
<p>       Use dynamically-generated table size estimates while planning (Tom)
      </p>
<p>       Formerly the planner estimated table sizes using the values seen
       by the last <code class="command">VACUUM</code> or <code class="command">ANALYZE</code>,
       both as to physical table size (number of pages) and number of rows.
       Now, the current physical table size is obtained from the kernel,
       and the number of rows is estimated by multiplying the table size
       by the row density (rows per page) seen by the last
       <code class="command">VACUUM</code> or <code class="command">ANALYZE</code>.  This should
       produce more reliable estimates in cases where the table size has
       changed significantly since the last housekeeping command.
      </p>
</li>
<li>
<p>       Improved index usage with <code class="literal">OR</code> clauses (Tom)
      </p>
<p>       This allows the optimizer to use indexes in statements with many OR
       clauses that would not have been indexed in the past.  It can also use
       multi-column indexes where the first column is specified and the second
       column is part of an <code class="literal">OR</code> clause.
      </p>
</li>
<li>
<p>       Improve matching of partial index clauses (Tom)
      </p>
<p>       The server is now smarter about using partial indexes in queries
       involving complex <code class="option">WHERE</code> clauses.
      </p>
</li>
<li>
<p>       Improve performance of the GEQO optimizer (Tom)
      </p>
<p>       The GEQO optimizer is used to plan queries involving many tables (by
       default, twelve or more). This release speeds up the way queries are
       analyzed to decrease time spent in optimization.
      </p>
</li>
<li>
<p>       Miscellaneous optimizer improvements
      </p>
<p>       There is not room here to list all the minor improvements made, but
       numerous special cases work better than in prior releases.
      </p>
</li>
<li>
<p>       Improve lookup speed for C functions (Tom)
      </p>
<p>       This release uses a hash table to lookup information for dynamically
       loaded C functions. This improves their speed so they perform nearly as
       quickly as functions that are built into the server executable.
      </p>
</li>
<li>
<p>       Add type-specific <code class="command">ANALYZE</code> statistics
       capability (Mark Cave-Ayland)
      </p>
<p>       This feature allows more flexibility in generating statistics
       for nonstandard data types.
      </p>
</li>
<li>
<p>       <code class="command">ANALYZE</code> now collects statistics for
       expression indexes (Tom)
      </p>
<p>       Expression indexes (also called functional indexes) allow users to
       index not just columns but the results of expressions and function
       calls. With this release, the optimizer can gather and use statistics
       about the contents of expression indexes.  This will greatly improve
       the quality of planning for queries in which an expression index is
       relevant.
      </p>
</li>
<li>
<p>       New two-stage sampling method for <code class="command">ANALYZE</code>
       (Manfred Koizar)
      </p>
<p>       This gives better statistics when the density of valid rows is very
       different in different regions of a table.
      </p>
</li>
<li>
<p>       Speed up <code class="command">TRUNCATE</code> (Tom)
      </p>
<p>       This buys back some of the performance loss observed in 7.4, while still
       keeping <code class="command">TRUNCATE</code> transaction-safe.
      </p>
</li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2891378">E.35.4.2. Server Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       Add WAL file archiving and point-in-time recovery (Simon Riggs)
      </p></li>
<li><p>       Add tablespaces so admins can control disk layout (Gavin)
      </p></li>
<li>
<p>       Add a built-in log rotation program (Andreas Pflug)
      </p>
<p>       It is now possible to log server messages conveniently without
       relying on either <span class="application">syslog</span> or an external log
       rotation program.
      </p>
</li>
<li><p>       Add new read-only server configuration parameters to show server
       compile-time settings: <code class="varname">block_size</code>,
       <code class="varname">integer_datetimes</code>, <code class="varname">max_function_args</code>,
       <code class="varname">max_identifier_length</code>, <code class="varname">max_index_keys</code>  (Joe)
      </p></li>
<li><p>       Make quoting of <code class="literal">sameuser</code>, <code class="literal">samegroup</code>, and
       <code class="literal">all</code> remove special meaning of these terms in
       <code class="filename">pg_hba.conf</code> (Andrew)
      </p></li>
<li><p>       Use clearer IPv6 name <code class="literal">::1/128</code> for
       <code class="literal">localhost</code> in default <code class="filename">pg_hba.conf</code> (Andrew)
      </p></li>
<li><p>       Use CIDR format in <code class="filename">pg_hba.conf</code> examples (Andrew)
      </p></li>
<li>
<p>       Rename server configuration parameters <code class="varname">SortMem</code> and
       <code class="varname">VacuumMem</code> to <code class="varname">work_mem</code> and
       <code class="varname">maintenance_work_mem</code> (Old names still supported) (Tom)
      </p>
<p>       This change was made to clarify that bulk operations such as index and
       foreign key creation use <code class="varname">maintenance_work_mem</code>, while
       <code class="varname">work_mem</code> is for workspaces used during query execution.
      </p>
</li>
<li><p>       Allow logging of session disconnections using server configuration
       <code class="varname">log_disconnections</code> (Andrew)
      </p></li>
<li>
<p>       Add new server configuration parameter <code class="varname">log_line_prefix</code> to
       allow control of information emitted in each log line (Andrew)
      </p>
<p>       Available information includes user name, database name, remote IP
       address, and session start time.
      </p>
</li>
<li><p>       Remove server configuration parameters <code class="varname">log_pid</code>,
       <code class="varname">log_timestamp</code>, <code class="varname">log_source_port</code>; functionality
       superseded by <code class="varname">log_line_prefix</code> (Andrew)
      </p></li>
<li>
<p>       Replace the <code class="varname">virtual_host</code> and <code class="varname">tcpip_socket</code>
       parameters with a unified <code class="varname">listen_addresses</code> parameter
       (Andrew, Tom)
      </p>
<p>       <code class="varname">virtual_host</code> could only specify a single IP address to
       listen on.  <code class="varname">listen_addresses</code> allows multiple addresses
       to be specified.
      </p>
</li>
<li>
<p>       Listen on localhost by default, which eliminates the need for the
       <code class="option">-i</code> postmaster switch in many scenarios (Andrew)
      </p>
<p>       Listening on localhost (<code class="literal">127.0.0.1</code>) opens no new
       security holes but allows configurations like Windows and JDBC,
       which do not support local sockets, to work without special
       adjustments.
      </p>
</li>
<li><p>       Remove <code class="varname">syslog</code> server configuration parameter, and add more
       logical <code class="varname">log_destination</code> variable to control log output
       location (Magnus)
      </p></li>
<li>
<p>       Change server configuration parameter <code class="varname">log_statement</code> to take
       values <code class="varname">all</code>, <code class="varname">mod</code>, <code class="varname">ddl</code>, or
       <code class="varname">none</code> to select which queries are logged (Bruce)
      </p>
<p>       This allows administrators to log only data definition changes or
       only data modification statements.
      </p>
</li>
<li><p>       Some logging-related configuration parameters could formerly be adjusted
       by ordinary users, but only in the &#8220;<span class="quote">more verbose</span>&#8221; direction.
       They are now treated more strictly: only superusers can set them.
       However, a superuser can use <code class="command">ALTER USER</code> to provide per-user
       settings of these values for non-superusers.  Also, it is now possible
       for superusers to set values of superuser-only configuration parameters
       via <code class="literal">PGOPTIONS</code>.
      </p></li>
<li>
<p>       Allow configuration files to be placed outside the data directory (mlw)
      </p>
<p>       By default, configuration files are kept in the cluster's top directory.
       With this addition, configuration files can be placed outside the
       data directory, easing administration.
      </p>
</li>
<li>
<p>       Plan prepared queries only when first executed so constants can be
       used for statistics (Oliver Jowett)
      </p>
<p>       Prepared statements plan queries once and execute them many
       times. While prepared queries avoid the overhead of re-planning
       on each use, the quality of the plan suffers from not knowing the exact
       parameters to be used in the query.  In this release, planning of
       unnamed prepared statements is delayed until the first execution,
       and the actual parameter values of that execution are used as
       optimization hints.  This allows use of out-of-line parameter passing
       without incurring a performance penalty.
      </p>
</li>
<li>
<p>       Allow <code class="command">DECLARE CURSOR</code> to take parameters
       (Oliver Jowett)
      </p>
<p>       It is now useful to issue <code class="command">DECLARE CURSOR</code> in a
       <code class="function">Parse</code> message with parameters. The parameter values
       sent at <code class="function">Bind</code> time will be substituted into the
       execution of the cursor's query.
      </p>
</li>
<li>
<p>       Fix hash joins and aggregates of <code class="type">inet</code> and
       <code class="type">cidr</code> data types (Tom)
      </p>
<p>       Release 7.4 handled hashing of mixed <code class="type">inet</code> and
       <code class="type">cidr</code> values incorrectly.  (This bug did not exist
       in prior releases because they wouldn't try to hash either
       data type.)
      </p>
</li>
<li><p>       Make <code class="varname">log_duration</code> print only when <code class="varname">log_statement</code>
       prints the query (Ed L.)
      </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2891779">E.35.4.3. Query Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       Add savepoints (nested transactions) (Alvaro)
      </p></li>
<li>
<p>       Unsupported isolation levels are now accepted and promoted to the
       nearest supported level (Peter)
      </p>
<p>       The SQL specification states that if a database doesn't support a
       specific isolation level, it should use the next more restrictive level.
       This change complies with that recommendation.
      </p>
</li>
<li><p>       Allow <code class="command">BEGIN WORK</code> to specify transaction
       isolation levels like <code class="command">START TRANSACTION</code> does
       (Bruce)
      </p></li>
<li><p>       Fix table permission checking for cases in which rules generate
       a query type different from the originally submitted query (Tom)
      </p></li>
<li>
<p>       Implement dollar quoting to simplify single-quote usage (Andrew, Tom,
       David Fetter)
      </p>
<p>       In previous releases, because single quotes had to be used to
       quote a function's body, the use of single quotes inside the
       function text required use of two single quotes or other error-prone
       notations. With this release we add the ability to use "dollar
       quoting" to quote a block of text.  The ability to use different
       quoting delimiters at different nesting levels greatly simplifies
       the task of quoting correctly, especially in complex functions.
       Dollar quoting can be used anywhere quoted text is needed.
      </p>
</li>
<li>
<p>       Make <code class="literal">CASE val WHEN compval1 THEN ...</code> evaluate <code class="literal">val</code> only once (Tom)
      </p>
<p>       <code class="option">CASE</code> no longer evaluates the tested expression multiple
       times. This has benefits when the expression is complex or is
       volatile.
      </p>
</li>
<li>
<p>       Test <code class="option">HAVING</code> before computing target list of an
       aggregate query (Tom)
      </p>
<p>       Fixes improper failure of cases such as <code class="literal">SELECT SUM(win)/SUM(lose)
       ... GROUP BY ... HAVING SUM(lose) &gt; 0</code>.  This should work but formerly
       could fail with divide-by-zero.
      </p>
</li>
<li>
<p>       Replace <code class="varname">max_expr_depth</code> parameter with
       <code class="varname">max_stack_depth</code> parameter, measured in kilobytes of stack
       size (Tom)
      </p>
<p>      This gives us a fairly bulletproof defense against crashing due to
      runaway recursive functions. Instead of measuring the depth of expression
      nesting, we now directly measure the size of the execution stack.
      </p>
</li>
<li>
<p>       Allow arbitrary row expressions (Tom)
      </p>
<p>       This release allows SQL expressions to contain arbitrary composite
       types, that is, row values. It also allows functions to more easily
       take rows as arguments and return row values.
      </p>
</li>
<li><p>       Allow <code class="option">LIKE</code>/<code class="option">ILIKE</code> to be used as the operator
       in row and subselect comparisons (Fabien Coelho)
      </p></li>
<li>
<p>       Avoid locale-specific case conversion of basic ASCII letters in
       identifiers and keywords (Tom)
      </p>
<p>       This solves the &#8220;<span class="quote">Turkish problem</span>&#8221; with mangling of words
       containing <code class="literal">I</code> and  <code class="literal">i</code>.  Folding of characters
       outside the 7-bit-ASCII set is still locale-aware.
      </p>
</li>
<li>
<p>       Improve syntax error reporting (Fabien, Tom)
      </p>
<p>       Syntax error reports are more useful than before.
      </p>
</li>
<li>
<p>       Change <code class="command">EXECUTE</code> to return a completion tag
       matching the executed statement (Kris Jurka)
      </p>
<p>       Previous releases return an <code class="command">EXECUTE</code> tag for
       any <code class="command">EXECUTE</code> call. In this release, the tag
       returned will reflect the command executed.
      </p>
</li>
<li>
<p>       Avoid emitting <code class="option">NATURAL CROSS JOIN</code> in rule listings (Tom)
      </p>
<p>       Such a clause makes no logical sense, but in some cases the rule
       decompiler formerly produced this syntax.
      </p>
</li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2891996">E.35.4.4. Object Manipulation Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       Add <code class="command">COMMENT ON</code> for casts, conversions, languages,
       operator classes, and large objects (Christopher)
      </p></li>
<li>
<p>       Add new server configuration parameter <code class="varname">default_with_oids</code> to
       control whether tables are created with <code class="type">OID</code>s by default (Neil)
      </p>
<p>       This allows administrators to control whether <code class="command">CREATE
       TABLE</code> commands create tables with or without <code class="type">OID</code>
       columns by default.  (Note: the current factory default setting for
       <code class="varname">default_with_oids</code> is <code class="literal">TRUE</code>, but the default
       will become <code class="literal">FALSE</code> in future releases.)
      </p>
</li>
<li><p>       Add <code class="option">WITH</code> / <code class="option">WITHOUT OIDS</code> clause to
       <code class="command">CREATE TABLE AS</code> (Neil)
      </p></li>
<li><p>       Allow <code class="command">ALTER TABLE DROP COLUMN</code> to drop an <code class="type">OID</code>
       column (<code class="command">ALTER TABLE SET WITHOUT OIDS</code> still works)
       (Tom)
      </p></li>
<li><p>       Allow composite types as table columns (Tom)
      </p></li>
<li>
<p>       Allow <code class="command">ALTER ... ADD COLUMN</code> with defaults and
       <code class="option">NOT NULL</code> constraints; works per SQL spec (Rod)
      </p>
<p>       It is now possible for <code class="option">ADD COLUMN</code> to create a column
       that is not initially filled with NULLs, but with a specified
       default value.
      </p>
</li>
<li>
<p>       Add <code class="command">ALTER COLUMN TYPE</code> to change column's type (Rod)
      </p>
<p>       It is now possible to alter a column's data type without dropping
       and re-adding the column.
      </p>
</li>
<li>
<p>       Allow multiple <code class="command">ALTER</code> actions in a single <code class="command">ALTER
       TABLE</code> command (Rod)
      </p>
<p>       This is particularly useful for <code class="command">ALTER</code> commands that
       rewrite the table (which include <code class="option">ALTER COLUMN TYPE</code> and
       <code class="option">ADD COLUMN</code> with a default). By grouping
       <code class="command">ALTER</code> commands together, the table need be rewritten
       only once.
      </p>
</li>
<li>
<p>       Allow <code class="command">ALTER TABLE</code> to add <code class="type">SERIAL</code>
       columns (Tom)
      </p>
<p>       This falls out from the new capability of specifying defaults for new
       columns.
      </p>
</li>
<li>
<p>       Allow changing the owners of aggregates, conversions, databases,
       functions, operators, operator classes, schemas, types, and tablespaces
       (Christopher, Euler Taveira de Oliveira)
      </p>
<p>       Previously this required modifying the system tables directly.
      </p>
</li>
<li><p>       Allow temporary object creation to be limited to <code class="option">SECURITY
       DEFINER</code> functions (Sean Chittenden)
      </p></li>
<li>
<p>       Add <code class="option">ALTER TABLE ... SET WITHOUT CLUSTER</code> (Christopher)
      </p>
<p>       Prior to this release, there was no way to clear an auto-cluster
       specification except to modify the system tables.
      </p>
</li>
<li>
<p>       Constraint/Index/<code class="type">SERIAL</code> names are now
       <em class="replaceable"><code>table_column_type</code></em>
       with numbers appended to guarantee uniqueness within the schema
       (Tom)
      </p>
<p>       The SQL specification states that such names should be unique
       within a schema.
      </p>
</li>
<li>
<p>       Add <code class="function">pg_get_serial_sequence()</code> to return a
       <code class="type">SERIAL</code> column's sequence name (Christopher)
      </p>
<p>       This allows automated scripts to reliably find the <code class="type">SERIAL</code>
       sequence name.
      </p>
</li>
<li><p>       Warn when primary/foreign key data type mismatch requires costly lookup
      </p></li>
<li><p>       New <code class="command">ALTER INDEX</code> command to allow moving of indexes
       between tablespaces (Gavin)
      </p></li>
<li><p>       Make <code class="command">ALTER TABLE OWNER</code> change dependent sequence
       ownership too (Alvaro)
      </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2892290">E.35.4.5. Utility Command Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       Allow <code class="command">CREATE SCHEMA</code> to create triggers,
       indexes, and sequences (Neil)
      </p></li>
<li>
<p>       Add <code class="option">ALSO</code> keyword to <code class="command">CREATE RULE</code> (Fabien
       Coelho)
      </p>
<p>       This allows <code class="option">ALSO</code> to be added to rule creation to contrast it with
       <code class="option">INSTEAD</code> rules.
      </p>
</li>
<li>
<p>       Add <code class="option">NOWAIT</code> option to <code class="command">LOCK</code> (Tatsuo)
      </p>
<p>       This allows the <code class="command">LOCK</code> command to fail if it
       would have to wait for the requested lock.
      </p>
</li>
<li><p>       Allow <code class="command">COPY</code> to read and write
       comma-separated-value (CSV) files (Andrew, Bruce)
      </p></li>
<li><p>       Generate error if the <code class="command">COPY</code> delimiter and NULL
       string conflict (Bruce)
      </p></li>
<li><p>       <code class="command">GRANT</code>/<code class="command">REVOKE</code> behavior
       follows the SQL spec more closely
      </p></li>
<li>
<p>       Avoid locking conflict between <code class="command">CREATE INDEX</code>
       and <code class="command">CHECKPOINT</code> (Tom)
      </p>
<p>       In 7.3 and 7.4, a long-running B-tree index build could block concurrent
       <code class="command">CHECKPOINT</code>s from completing, thereby causing WAL bloat because the
       WAL log could not be recycled.
      </p>
</li>
<li>
<p>       Database-wide <code class="command">ANALYZE</code> does not hold locks
       across tables (Tom)
      </p>
<p>       This reduces the potential for deadlocks against other backends
       that want exclusive locks on tables.  To get the benefit of this
       change, do not execute database-wide <code class="command">ANALYZE</code>
       inside a transaction block (<code class="command">BEGIN</code> block); it
       must be able to commit and start a new transaction for each
       table.
      </p>
</li>
<li>
<p>       <code class="command">REINDEX</code> does not exclusively lock the index's
       parent table anymore
      </p>
<p>       The index itself is still exclusively locked, but readers of the
       table can continue if they are not using the particular index
       being rebuilt.
      </p>
</li>
<li>
<p>       Erase MD5 user passwords when a user is renamed (Bruce)
      </p>
<p>       <span class="productname">PostgreSQL</span> uses the user name as salt
       when encrypting passwords via MD5. When a user's name is changed,
       the salt will no longer match the stored MD5 password, so the
       stored password becomes useless.  In this release a notice is
       generated and the password is cleared.  A new password must then
       be assigned if the user is to be able to log in with a password.
      </p>
</li>
<li>
<p>       New <span class="application">pg_ctl</span> <code class="option">kill</code> option for Windows (Andrew)
      </p>
<p>       Windows does not have a <code class="literal">kill</code> command to send signals to
       backends so this capability was added to <span class="application">pg_ctl</span>.
      </p>
</li>
<li><p>       Information schema improvements
      </p></li>
<li><p>       Add <code class="option">--pwfile</code> option to
       <span class="application">initdb</span> so the initial password can be
       set by GUI tools (Magnus)
      </p></li>
<li><p>       Detect locale/encoding mismatch in
       <span class="application">initdb</span> (Peter)
      </p></li>
<li><p>       Add <code class="option">register</code> command to <span class="application">pg_ctl</span> to
       register Windows operating system service (Dave Page)
      </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2892555">E.35.4.6. Data Type and Function Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>       More complete support for composite types (row types)  (Tom)
      </p>
<p>       Composite values can be used in many places where only scalar values
       worked before.
      </p>
</li>
<li>
<p>       Reject nonrectangular array values as erroneous (Joe)
      </p>
<p>       Formerly, <code class="function">array_in</code> would silently build a
       surprising result.
      </p>
</li>
<li><p>        Overflow in integer arithmetic operations is now detected (Tom)
       </p></li>
<li>
<p>        The arithmetic operators associated with the single-byte
        <code class="type">"char"</code> data type have been removed.
       </p>
<p>        Formerly, the parser would select these operators in many situations
        where an &#8220;<span class="quote">unable to select an operator</span>&#8221; error would be more
        appropriate, such as <code class="literal">null * null</code>.  If you actually want
        to do arithmetic on a <code class="type">"char"</code> column, you can cast it to
        integer explicitly.
       </p>
</li>
<li>
<p>        Syntax checking of array input values considerably tightened up (Joe)
       </p>
<p>        Junk that was previously allowed in odd places with odd results
        now causes an <code class="literal">ERROR</code>, for example, non-whitespace
        after the closing right brace.
       </p>
</li>
<li>
<p>        Empty-string array element values must now be written as
        <code class="literal">""</code>, rather than writing nothing (Joe)
       </p>
<p>        Formerly, both ways of writing an empty-string element value were
        allowed, but now a quoted empty string is required.  The case where
        nothing at all appears will probably be considered to be a NULL
        element value in some future release.
       </p>
</li>
<li>
<p>        Array element trailing whitespace is now ignored (Joe)
       </p>
<p>        Formerly leading whitespace was ignored, but trailing whitespace
        between an element value and the delimiter or right brace was
        significant.  Now trailing whitespace is also ignored.
       </p>
</li>
<li><p>       Emit array values with explicit array bounds when lower bound is not one
       (Joe)
      </p></li>
<li><p>       Accept <code class="literal">YYYY-monthname-DD</code> as a date string (Tom)
      </p></li>
<li><p>       Make <code class="function">netmask</code> and <code class="function">hostmask</code> functions
       return maximum-length mask length (Tom)
      </p></li>
<li>
<p>       Change factorial function to return <code class="type">numeric</code> (Gavin)
      </p>
<p>       Returning <code class="type">numeric</code> allows the factorial function to
       work for a wider range of input values.
      </p>
</li>
<li><p>       <code class="function">to_char</code>/<code class="function">to_date()</code> date conversion
       improvements (Kurt Roeckx, Fabien Coelho)
      </p></li>
<li>
<p>       Make <code class="function">length()</code> disregard trailing spaces in
       <code class="type">CHAR(n)</code> (Gavin)
      </p>
<p>       This change was made to improve consistency: trailing spaces are
       semantically insignificant in <code class="type">CHAR(n)</code> data, so they
       should not be counted by <code class="function">length()</code>.
      </p>
</li>
<li>
<p>       Warn about empty string being passed to
       <code class="type">OID</code>/<code class="type">float4</code>/<code class="type">float8</code> data types (Neil)
      </p>
<p>       8.1 will throw an error instead.
      </p>
</li>
<li><p>       Allow leading or trailing whitespace in
       <code class="type">int2</code>/<code class="type">int4</code>/<code class="type">int8</code>/<code class="type">float4</code>/<code class="type">float8</code>
       input routines
       (Neil)
      </p></li>
<li>
<p>       Better support for IEEE <code class="literal">Infinity</code> and <code class="literal">NaN</code>
       values in <code class="type">float4</code>/<code class="type">float8</code> (Neil)
      </p>
<p>       These should now work on all platforms that support IEEE-compliant
       floating point arithmetic.
      </p>
</li>
<li><p>       Add <code class="option">week</code> option to <code class="function">date_trunc()</code> (Robert Creager)
      </p></li>
<li><p>       Fix <code class="function">to_char</code> for <code class="literal">1 BC</code>
       (previously it returned <code class="literal">1 AD</code>) (Bruce)
      </p></li>
<li><p>       Fix <code class="function">date_part(year)</code> for BC dates (previously it
       returned one less than the correct year) (Bruce)
      </p></li>
<li>
<p>       Fix <code class="function">date_part()</code> to return the proper millennium and
       century (Fabien Coelho)
      </p>
<p>       In previous versions, the century and millennium results had a wrong
       number and started in the wrong year, as compared to standard
       reckoning of such things.
      </p>
</li>
<li><p>       Add <code class="function">ceiling()</code> as an alias for <code class="function">ceil()</code>,
       and <code class="function">power()</code> as an alias for <code class="function">pow()</code> for
       standards compliance (Neil)
      </p></li>
<li><p>       Change <code class="function">ln()</code>, <code class="function">log()</code>,
       <code class="function">power()</code>, and <code class="function">sqrt()</code> to emit the correct
       <code class="literal">SQLSTATE</code> error codes for certain error conditions, as
       specified by SQL:2003 (Neil)
      </p></li>
<li><p>       Add <code class="function">width_bucket()</code> function as defined by SQL:2003 (Neil)
      </p></li>
<li><p>       Add <code class="function">generate_series()</code> functions to simplify working
       with numeric sets (Joe)
      </p></li>
<li><p>       Fix <code class="function">upper/lower/initcap()</code> functions to work with
       multibyte encodings (Tom)
      </p></li>
<li><p>       Add boolean and bitwise integer <code class="option">AND</code>/<code class="option">OR</code>
       aggregates (Fabien Coelho)
      </p></li>
<li><p>       New session information functions to return network addresses for client
       and server (Sean Chittenden)
      </p></li>
<li><p>       Add function to determine the area of a closed path (Sean Chittenden)
      </p></li>
<li><p>       Add function to send cancel request to other backends (Magnus)
      </p></li>
<li>
<p>       Add <code class="type">interval</code> plus <code class="type">datetime</code> operators (Tom)
      </p>
<p>       The reverse ordering, <code class="type">datetime</code> plus <code class="type">interval</code>,
       was already supported, but both are required by the SQL standard.
      </p>
</li>
<li>
<p>       Casting an integer to <code class="type">BIT(N)</code> selects the rightmost N bits
       of the integer
       (Tom)
      </p>
<p>       In prior releases, the leftmost N bits were selected, but this was
       deemed unhelpful, not to mention inconsistent with casting from bit
       to int.
      </p>
</li>
<li><p>       Require <code class="type">CIDR</code> values to have all nonmasked bits be zero
       (Kevin Brintnall)
      </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2893047">E.35.4.7. Server-Side Language Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       In <code class="literal">READ COMMITTED</code> serialization mode, volatile functions
       now see the results of concurrent transactions committed up to the
       beginning of each statement within the function, rather than up to the
       beginning of the interactive command that called the function.
      </p></li>
<li><p>       Functions declared <code class="literal">STABLE</code> or <code class="literal">IMMUTABLE</code> always
       use the snapshot of the calling query, and therefore do not see the
       effects of actions taken after the calling query starts, whether in
       their own transaction or other transactions.  Such a function must be
       read-only, too, meaning that it cannot use any SQL commands other than
       <code class="command">SELECT</code>.  There is a considerable performance gain from
       declaring a function <code class="literal">STABLE</code> or <code class="literal">IMMUTABLE</code>
       rather than <code class="literal">VOLATILE</code>.
      </p></li>
<li><p>       Nondeferred <code class="option">AFTER</code> triggers are now fired immediately
       after completion of the triggering query, rather than upon
       finishing the current interactive command. This makes a difference
       when the triggering query occurred within a function: the trigger
       is invoked before the function proceeds to its next operation. For
       example, if a function inserts a new row into a table, any
       nondeferred foreign key checks occur before proceeding with the
       function.
      </p></li>
<li>
<p>       Allow function parameters to be declared with names (Dennis Björklund)
      </p>
<p>       This allows better documentation of functions.  Whether the names
       actually do anything depends on the specific function language
       being used.
      </p>
</li>
<li>
<p>       Allow PL/pgSQL parameter names to be referenced in the function (Dennis Björklund)
      </p>
<p>       This basically creates an automatic alias for each named parameter.
      </p>
</li>
<li>
<p>       Do minimal syntax checking of PL/pgSQL functions at creation time (Tom)
      </p>
<p>       This allows us to catch simple syntax errors sooner.
      </p>
</li>
<li>
<p>       More support for composite types (row and record variables) in PL/pgSQL
      </p>
<p>       For example, it now works to pass a rowtype variable to another function
       as a single variable.
      </p>
</li>
<li><p>       Default values for PL/pgSQL variables can now reference previously
       declared variables
      </p></li>
<li>
<p>       Improve parsing of PL/pgSQL FOR loops (Tom)
      </p>
<p>       Parsing is now driven by presence of <code class="literal">".."</code> rather than
       data type of <code class="option">FOR</code> variable. This makes no difference for
       correct functions, but should result in more understandable error
       messages when a mistake is made.
      </p>
</li>
<li><p>       Major overhaul of PL/Perl server-side language (Command Prompt, Andrew Dunstan)
      </p></li>
<li><p>       In PL/Tcl, SPI commands are now run in subtransactions.  If an error
       occurs, the subtransaction is cleaned up and the error is reported
       as an ordinary Tcl error, which can be trapped with <code class="literal">catch</code>.
       Formerly, it was not possible to catch such errors.
      </p></li>
<li>
<p>       Accept <code class="command">ELSEIF</code> in PL/pgSQL (Neil)
      </p>
<p>       Previously PL/pgSQL only allowed <code class="command">ELSIF</code>, but many people
       are accustomed to spelling this keyword <code class="command">ELSEIF</code>.
      </p>
</li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2893233">E.35.4.8. <span class="application">psql</span> Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       Improve <span class="application">psql</span> information display about database
       objects (Christopher)
      </p></li>
<li><p>       Allow <span class="application">psql</span> to display group membership in
       <code class="command">\du</code> and <code class="command">\dg</code> (Markus Bertheau)
      </p></li>
<li><p>       Prevent <span class="application">psql</span> <code class="command">\dn</code> from showing
       temporary schemas (Bruce)
      </p></li>
<li><p>       Allow <span class="application">psql</span> to handle tilde user expansion for file
       names (Zach Irmen)
      </p></li>
<li><p>       Allow <span class="application">psql</span> to display fancy prompts, including
       color, via <span class="application">readline</span> (Reece Hart, Chet Ramey)
      </p></li>
<li><p>       Make <span class="application">psql</span> <code class="command">\copy</code> match <code class="command">COPY</code> command syntax
       fully (Tom)
      </p></li>
<li><p>       Show the location of syntax errors (Fabien Coelho, Tom)
      </p></li>
<li><p>       Add <code class="command">CLUSTER</code> information to <span class="application">psql</span>
       <code class="command">\d</code> display
       (Bruce)
      </p></li>
<li><p>       Change <span class="application">psql</span> <code class="command">\copy stdin/stdout</code> to read
       from command input/output (Bruce)
      </p></li>
<li><p>       Add <code class="option">pstdin</code>/<code class="option">pstdout</code> to read from
       <span class="application">psql</span>'s <code class="literal">stdin</code>/<code class="literal">stdout</code> (Mark
       Feit)
      </p></li>
<li>
<p>       Add global <span class="application">psql</span> configuration file, <code class="filename">psqlrc.sample</code>
       (Bruce)
      </p>
<p>       This allows a central file where global <span class="application">psql</span> startup commands can
       be stored.
      </p>
</li>
<li><p>       Have <span class="application">psql</span> <code class="command">\d+</code> indicate if the table
       has an <code class="type">OID</code> column (Neil)
      </p></li>
<li><p>       On Windows, use binary mode in <span class="application">psql</span> when reading files so control-Z
       is not seen as end-of-file
      </p></li>
<li><p>       Have <code class="command">\dn+</code> show permissions and description for schemas (Dennis
       Björklund)
      </p></li>
<li><p>       Improve tab completion support (Stefan Kaltenbrunn, Greg Sabino Mullane)
      </p></li>
<li><p>       Allow boolean settings to be set using upper or lower case (Michael Paesold)
      </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2893489">E.35.4.9. <span class="application">pg_dump</span> Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>       Use dependency information to improve the reliability of
       <span class="application">pg_dump</span> (Tom)
      </p>
<p>       This should solve the longstanding problems with related objects
       sometimes being dumped in the wrong order.
      </p>
</li>
<li>
<p>       Have <span class="application">pg_dump</span> output objects in alphabetical order if possible (Tom)
      </p>
<p>       This should make it easier to identify changes between
       dump files.
      </p>
</li>
<li>
<p>       Allow <span class="application">pg_restore</span> to ignore some SQL errors (Fabien Coelho)
      </p>
<p>       This makes <span class="application">pg_restore</span>'s behavior similar to the
       results of feeding a <span class="application">pg_dump</span> output script to
       <span class="application">psql</span>. In most cases, ignoring errors and plowing
       ahead is the most useful thing to do. Also added was a pg_restore
       option to give the old behavior of exiting on an error.
      </p>
</li>
<li><p>       <span class="application">pg_restore</span> <code class="option">-l</code> display now includes
       objects' schema names
      </p></li>
<li><p>       New begin/end markers in <span class="application">pg_dump</span> text output (Bruce)
      </p></li>
<li><p>       Add start/stop times for
       <span class="application">pg_dump</span>/<span class="application">pg_dumpall</span> in verbose mode
       (Bruce)
      </p></li>
<li><p>       Allow most <span class="application">pg_dump</span> options in
       <span class="application">pg_dumpall</span> (Christopher)
      </p></li>
<li><p>       Have <span class="application">pg_dump</span> use <code class="command">ALTER OWNER</code> rather
       than <code class="command">SET SESSION AUTHORIZATION</code> by default
       (Christopher)
      </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2893639">E.35.4.10. libpq Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       Make libpq's <code class="option">SIGPIPE</code> handling thread-safe (Bruce)
      </p></li>
<li><p>       Add <code class="function">PQmbdsplen()</code> which returns the display length
       of a character (Tatsuo)
      </p></li>
<li><p>       Add thread locking to <span class="application">SSL</span> and
       <span class="application">Kerberos</span> connections (Manfred Spraul)
      </p></li>
<li><p>       Allow <code class="function">PQoidValue()</code>, <code class="function">PQcmdTuples()</code>, and
       <code class="function">PQoidStatus()</code> to work on <code class="command">EXECUTE</code>
       commands (Neil)
      </p></li>
<li><p>       Add <code class="function">PQserverVersion()</code> to provide more convenient
       access to the server version number (Greg Sabino Mullane)
      </p></li>
<li><p>       Add <code class="function">PQprepare/PQsendPrepared()</code> functions to support
       preparing statements without necessarily specifying the data types
       of their parameters (Abhijit Menon-Sen)
      </p></li>
<li><p>       Many ECPG improvements, including <code class="command">SET DESCRIPTOR</code> (Michael)
      </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2893741">E.35.4.11. Source Code Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       Allow the database server to run natively on Windows (Claudio, Magnus, Andrew)
      </p></li>
<li><p>       Shell script commands converted to C versions for Windows support (Andrew)
      </p></li>
<li>
<p>       Create an extension makefile framework (Fabien Coelho, Peter)
      </p>
<p>       This simplifies the task of building extensions outside the original
       source tree.
      </p>
</li>
<li>
<p>       Support relocatable installations (Bruce)
      </p>
<p>       Directory paths for installed files (such as the
       <code class="filename">/share</code> directory) are now computed relative to the
       actual location of the executables, so that an installation tree
       can be moved to another place without reconfiguring and
       rebuilding.
      </p>
</li>
<li><p>       Use <code class="option">--with-docdir</code> to choose installation location of documentation; also
       allow <code class="option">--infodir</code> (Peter)
      </p></li>
<li><p>       Add <code class="option">--without-docdir</code> to prevent installation of documentation (Peter)
      </p></li>
<li><p>       Upgrade to <span class="application">DocBook</span> V4.2 SGML (Peter)
      </p></li>
<li>
<p>       New <code class="literal">PostgreSQL</code> <span class="application">CVS</span> tag (Marc)
      </p>
<p>       This was done to make it easier for organizations to manage their
       own copies of the <span class="productname">PostgreSQL</span>
       <span class="application">CVS</span> repository. File version stamps from the master
       repository will not get munged by checking into or out of a copied
       repository.
      </p>
</li>
<li><p>       Clarify locking code (Manfred Koizar)
      </p></li>
<li><p>       Buffer manager cleanup (Neil)
      </p></li>
<li><p>       Decouple platform tests from CPU spinlock code (Bruce, Tom)
      </p></li>
<li><p>       Add inlined test-and-set code on PA-RISC for <span class="application">gcc</span>
       (ViSolve, Tom)
      </p></li>
<li><p>       Improve i386 spinlock code (Manfred Spraul)
      </p></li>
<li><p>       Clean up spinlock assembly code to avoid warnings from newer
       <span class="application">gcc</span> releases (Tom)
      </p></li>
<li><p>       Remove JDBC from source tree; now a separate project
      </p></li>
<li><p>       Remove the libpgtcl client interface; now a separate project
      </p></li>
<li><p>       More accurately estimate memory and file descriptor usage (Tom)
      </p></li>
<li><p>       Improvements to the Mac OS X startup scripts (Ray A.)
      </p></li>
<li><p>       New <code class="function">fsync()</code> test program (Bruce)
      </p></li>
<li><p>       Major documentation improvements (Neil, Peter)
      </p></li>
<li><p>       Remove <span class="application">pg_encoding</span>; not needed
       anymore
      </p></li>
<li><p>       Remove <span class="application">pg_id</span>; not needed anymore
      </p></li>
<li><p>       Remove <span class="application">initlocation</span>; not needed
       anymore
      </p></li>
<li><p>       Auto-detect thread flags (no more manual testing) (Bruce)
      </p></li>
<li><p>       Use Olson's public domain <span class="application">timezone</span> library (Magnus)
      </p></li>
<li>
<p>       With threading enabled, use thread flags on Unixware for
       backend executables too (Bruce)
      </p>
<p>       Unixware cannot mix threaded and nonthreaded object files in the
       same executable, so everything must be compiled as threaded.
      </p>
</li>
<li><p>       <span class="application">psql</span> now uses a <span class="application">flex</span>-generated
       lexical analyzer to process command strings
      </p></li>
<li>
<p>       Reimplement the linked list data structure used throughout the
       backend (Neil)
      </p>
<p>       This improves performance by allowing list append and length
       operations to be more efficient.
      </p>
</li>
<li><p>       Allow dynamically loaded modules to create their own server configuration
       parameters (Thomas Hallgren)
      </p></li>
<li><p>       New Brazilian version of FAQ (Euler Taveira de Oliveira)
      </p></li>
<li><p>       Add French FAQ (Guillaume Lelarge)
      </p></li>
<li><p>       New <span class="application">pgevent</span> for Windows logging
      </p></li>
<li><p>       Make libpq and ECPG build as proper shared libraries on OS X (Tom)
      </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title" id="id2894022">E.35.4.12. Contrib Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>       Overhaul of <code class="filename">contrib/dblink</code> (Joe)
      </p></li>
<li><p>       <code class="filename">contrib/dbmirror</code> improvements (Steven Singer)
      </p></li>
<li><p>       New <code class="filename">contrib/xml2</code> (John Gray, Torchbox)
      </p></li>
<li><p>       Updated <code class="filename">contrib/mysql</code>
      </p></li>
<li><p>       New version of <code class="filename">contrib/btree_gist</code> (Teodor)
      </p></li>
<li><p>       New <code class="filename">contrib/trgm</code>, trigram matching for
       <span class="productname">PostgreSQL</span> (Teodor)
      </p></li>
<li><p>       Many <code class="filename">contrib/tsearch2</code> improvements (Teodor)
      </p></li>
<li><p>       Add double metaphone to <code class="filename">contrib/fuzzystrmatch</code> (Andrew)
      </p></li>
<li><p>       Allow <code class="filename">contrib/pg_autovacuum</code> to run as a Windows service (Dave Page)
      </p></li>
<li><p>       Add functions to <code class="filename">contrib/dbsize</code> (Andreas Pflug)
      </p></li>
<li><p>       Removed <code class="filename">contrib/pg_logger</code>: obsoleted by integrated logging
       subprocess
      </p></li>
<li><p>       Removed <code class="filename">contrib/rserv</code>: obsoleted by various separate projects
      </p></li>
</ul></div>
</div>
</div>
</div></body>
</html>
