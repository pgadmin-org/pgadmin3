<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>E.8. Release 8.1</title>
<link rel="stylesheet" href="stylesheet.css" type="text/css">
<link rev="made" href="pgsql-docs@postgresql.org">
<meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
<link rel="start" href="index.html" title="PostgreSQL 8.1.7 Documentation">
<link rel="up" href="release.html" title="Appendix E. Release Notes">
<link rel="prev" href="release-8-1-1.html" title="E.7. Release 8.1.1">
<link rel="next" href="release-8-0-11.html" title="E.9. Release 8.0.11">
<link rel="copyright" href="ln-legalnotice.html" title="Legal Notice">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect1" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="release-8-1"></a>E.8. Release 8.1</h2></div></div></div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<h3 class="title">Release date</h3>
<p>2005-11-08</p>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id2833656"></a>E.8.1. Overview</h3></div></div></div>
<p>     Major changes in this release:
    </p>
<div class="variablelist"><dl>
<dt><span class="term">       Improve concurrent access to the shared buffer cache (Tom)
      </span></dt>
<dd><p>        Access to the shared buffer cache was identified as a
        significant scalability problem, particularly on multi-CPU
        systems. In this release, the way that locking is done in the
        buffer manager has been overhauled to reduce lock contention
        and improve scalability. The buffer manager has also been
        changed to use a &#8220;<span class="quote">clock sweep</span>&#8221; replacement
        policy.
       </p></dd>
<dt><span class="term">       Allow index scans to use an intermediate in-memory bitmap (Tom)
      </span></dt>
<dd><p>        In previous releases, only a single index could be used to do
        lookups on a table. With this feature, if a query has
        <code class="command">WHERE tab.col1 = 4 and tab.col2 = 9</code>, and there is
        no multicolumn index on <code class="literal">col1</code> and <code class="literal">col2</code>,
        but there is an index on <code class="literal">col1</code> and another on
        <code class="literal">col2</code>, it is possible to search both indexes and
        combine the results in memory, then do heap fetches for only
        the rows matching both the <code class="literal">col1</code> and
        <code class="literal">col2</code> restrictions. This is very useful in
        environments that have a lot of unstructured queries where it
        is impossible to create indexes that match all possible access
        conditions.  Bitmap scans are useful even with a single index,
        as they reduce the amount of random access needed; a bitmap
        index scan is efficient for retrieving fairly large fractions
        of the complete table, whereas plain index scans are not.
       </p></dd>
<dt><span class="term">       Add two-phase commit (Heikki Linnakangas, Alvaro, Tom)
      </span></dt>
<dd><p>        Two-phase commit allows transactions to be "prepared" on several
        computers, and once all computers have successfully prepared
        their transactions (none failed), all transactions can be
        committed. Even if a machine crashes after a prepare, the
        prepared transaction can be committed after the machine is
        restarted. New syntax includes <code class="command">PREPARE TRANSACTION</code> and
        <code class="command">COMMIT/ROLLBACK PREPARED</code>. A new system view
        <code class="literal">pg_prepared_xacts</code> has also been added.
       </p></dd>
<dt><span class="term">       Create a new role system that replaces users and groups 
       (Stephen Frost)
      </span></dt>
<dd>
<p>        Roles are a combination of users and groups. Like users, they
        can have login capability, and like groups, a role can have
        other roles as members. Roles basically remove the distinction
        between users and groups. For example, a role can:
       </p>
<div class="itemizedlist"><ul type="disc">
<li><p>           Have login capability (optionally)
         </p></li>
<li><p>          Own objects
         </p></li>
<li><p>          Hold access permissions for database objects
         </p></li>
<li><p>          Inherit permissions from other roles it is a member of
         </p></li>
</ul></div>
<p>        Once a user logs into a role, she obtains capabilities of
        the login role plus any inherited roles, and can use
        <code class="command">SET ROLE</code> to switch to other roles she is a member of.
        This feature is a generalization of the SQL standard's concept of
        roles.
        This change also replaces <code class="structname">pg_shadow</code> and 
        <code class="structname">pg_group</code> by new role-capable catalogs 
        <code class="structname">pg_authid</code> and <code class="structname">pg_auth_members</code>. The old
        tables are redefined as read-only views on the new role tables.
       </p>
</dd>
<dt><span class="term">       Automatically use indexes for <code class="function">MIN()</code> and
       <code class="function">MAX()</code> (Tom)
      </span></dt>
<dd><p>        In previous releases, the only way to use an index for
        <code class="function">MIN()</code> or <code class="function">MAX()</code> was to rewrite the
        query as <code class="command">SELECT col FROM tab ORDER BY col LIMIT 1</code>.
        Index usage now happens automatically.
       </p></dd>
<dt><span class="term">       Move <code class="filename">/contrib/pg_autovacuum</code> into the main server
       (Alvaro)
      </span></dt>
<dd><p>        Integrating autovacuum into the server allows it to be
        automatically started and stopped in sync with the database
        server, and allows autovacuum to be configured from
        <code class="filename">postgresql.conf</code>.
       </p></dd>
<dt><span class="term">       Add shared row level locks using <code class="command">SELECT ... FOR SHARE</code>
       (Alvaro)
      </span></dt>
<dd><p>        While <span class="productname">PostgreSQL</span>'s MVCC locking
        allows <code class="command">SELECT</code> to never be blocked by writers and
        therefore does not need shared row locks for typical operations,
        shared locks are useful for applications that require shared row
        locking.  In particular this reduces the locking requirements
        imposed by referential integrity checks.
       </p></dd>
<dt><span class="term">       Add dependencies on shared objects, specifically roles
       (Alvaro)
      </span></dt>
<dd><p>        This extension of the dependency mechanism prevents roles from
        being dropped while there are still database objects they own.
        Formerly it was possible to accidentally &#8220;<span class="quote">orphan</span>&#8221; objects by
        deleting their owner.  While this could be recovered from, it
        was messy and unpleasant.
       </p></dd>
<dt><span class="term">       Improve performance for partitioned tables (Simon)
      </span></dt>
<dd>
<p>        The new <code class="varname">constraint_exclusion</code> configuration
        parameter avoids lookups on child tables where constraints indicate
        that no matching rows exist in the child table.
       </p>
<p>        This allows for a basic type of table partitioning. If child tables
        store separate key ranges and this is enforced using appropriate
        <code class="command">CHECK</code> constraints, the optimizer will skip child
        table accesses when the constraint guarantees no matching rows
        exist in the child table.
       </p>
</dd>
</dl></div>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id2833982"></a>E.8.2. Migration to version 8.1</h3></div></div></div>
<p>     A dump/restore using <span class="application">pg_dump</span> is required
     for those wishing to migrate data from any previous release.
    </p>
<p>     The 8.0 release announced that the <code class="function">to_char()</code> function
     for intervals would be removed in 8.1. However, since no better API
     has been suggested, <code class="function">to_char(interval)</code> has been enhanced in
     8.1 and will remain in the server.
    </p>
<p>     Observe the following incompatibilities:
    </p>
<div class="itemizedlist"><ul type="disc">
<li>
<p>       <code class="varname">add_missing_from</code> is now false by default (Neil)
      </p>
<p>       By default, we now generate an error if a table is used in a query
       without a <code class="literal">FROM</code> reference.  The old behavior is still
       available, but the parameter must be set to 'true' to obtain it.
      </p>
<p>       It may be necessary to set <code class="varname">add_missing_from</code> to true
       in order to load an existing dump file, if the dump contains any
       views or rules created using the implicit-<code class="literal">FROM</code> syntax.
       This should be a one-time annoyance, because
       <span class="productname">PostgreSQL</span> 8.1 will convert
       such views and rules to standard explicit-<code class="literal">FROM</code> syntax.
       Subsequent dumps will therefore not have the problem.
      </p>
</li>
<li>
<p>       Cause input of a zero-length string (<code class="literal">''</code>) for
       <code class="type">float4</code>/<code class="type">float8</code>/<code class="type">oid</code>
       to throw an error, rather than treating it as a zero (Neil)
      </p>
<p>       This change is consistent with the current handling of
       zero-length strings for integers. The schedule for this change
       was announced in 8.0.
      </p>
</li>
<li>
<p>       <code class="varname">default_with_oids</code> is now false by default (Neil)
      </p>
<p>       With this option set to false, user-created tables no longer
       have an OID column unless <code class="command">WITH OIDS</code> is specified in
       <code class="command">CREATE TABLE</code>. Though OIDs have existed in all
       releases of <span class="productname">PostgreSQL</span>, their use is limited
       because they are only four bytes long and the counter is shared
       across all installed databases. The preferred way of uniquely
       identifying rows is via sequences and the <code class="type">SERIAL</code> type,
       which have been supported since <span class="productname">PostgreSQL</span> 6.4.
      </p>
</li>
<li>
<p>       Add <code class="literal">E''</code> syntax so eventually ordinary strings can
       treat backslashes literally (Bruce)
      </p>
<p>       Currently <span class="productname">PostgreSQL</span> processes a
       backslash in a string literal as introducing a special escape sequence,
       e.g. <code class="literal">\n</code> or <code class="literal">\010</code>.
       While this allows easy entry of special values, it is
       nonstandard and makes porting of applications from other
       databases more difficult. For this reason, the
       <span class="productname">PostgreSQL</span> project is planning to
       remove the special meaning of backslashes in strings. For
       backward compatibility and for users who want special backslash
       processing, a new string syntax has been created. This new string
       syntax is formed by writing an <code class="literal">E</code> immediately preceding the
       single quote that starts the string, e.g. <code class="literal">E'hi\n'</code>. While
       this release does not change the handling of backslashes in strings, it
       does add new configuration parameters to help users migrate applications
       for future releases:
      </p>
<div class="itemizedlist"><ul type="circle">
<li><p>         <code class="varname">standard_conforming_strings</code> [mdash ] does this release
         treat backslashes literally in ordinary strings?
        </p></li>
<li><p>        <code class="varname">escape_string_warning</code> [mdash ] warn about backslashes in
        ordinary (non-E) strings
       </p></li>
</ul></div>
<p>       The <code class="varname">standard_conforming_strings</code> value is read-only.
       Applications can retrieve the value to know how backslashes are
       processed.  (Presence of the parameter can also be taken as an
       indication that <code class="literal">E''</code> string syntax is supported.)
       In a future release, <code class="varname">standard_conforming_strings</code>
       will be true, meaning backslashes will be treated literally in
       non-E strings. To prepare for this change, use <code class="literal">E''</code>
       strings in places that need special backslash processing, and
       turn on <code class="varname">escape_string_warning</code> to find additional
       strings that need to be converted to use <code class="literal">E''</code>.
       Also, use two single-quotes (<code class="literal">''</code>) to embed a literal
       single-quote in a string, rather than the
       <span class="productname">PostgreSQL</span>-supported syntax of
       backslash single-quote (<code class="literal">\'</code>).  The former is
       standards-conforming and does not require the use of the
       <code class="literal">E''</code> string syntax.  You can also use the
       <code class="literal">$$</code> string syntax, which does not treat backslashes
       specially.
      </p>
</li>
<li>
<p>       Make <code class="command">REINDEX DATABASE</code> reindex all indexes in the
       database (Tom)
      </p>
<p>       Formerly, <code class="command">REINDEX DATABASE</code> reindexed only
       system tables. This new behavior seems more intuitive. A new
       command <code class="command">REINDEX SYSTEM</code> provides the old functionality
       of reindexing just the system tables.
      </p>
</li>
<li>
<p>       Read-only large object descriptors now obey MVCC snapshot semantics
      </p>
<p>       When a large object is opened with <code class="literal">INV_READ</code> (and not
       <code class="literal">INV_WRITE</code>), the data read from the descriptor will now
       reflect a &#8220;<span class="quote">snapshot</span>&#8221; of the large object's state at the
       time of the transaction snapshot in use by the query that called
       <code class="function">lo_open()</code>.  To obtain the old behavior of always
       returning the latest committed data, include <code class="literal">INV_WRITE</code>
       in the mode flags for <code class="function">lo_open()</code>.
      </p>
</li>
<li>
<p>       Add proper dependencies for arguments of sequence functions (Tom)
      </p>
<p>       In previous releases, sequence names passed to <code class="function">nextval()</code>,
       <code class="function">currval()</code>, and <code class="function">setval()</code> were stored as
       simple text strings, meaning that renaming or dropping a
       sequence used in a <code class="literal">DEFAULT</code> clause made the clause
       invalid. This release stores all newly-created sequence function
       arguments as internal OIDs, allowing them to track sequence
       renaming, and adding dependency information that prevents
       improper sequence removal. It also makes such <code class="literal">DEFAULT</code>
       clauses immune to schema renaming and search path changes.
      </p>
<p>       Some applications might rely on the old behavior of
       run-time lookup for sequence names. This can still be done by
       explicitly casting the argument to <code class="type">text</code>, for example
       <code class="literal">nextval('myseq'::text)</code>.
      </p>
<p>       Pre-8.1 database dumps loaded into 8.1 will use the old text-based
       representation and therefore will not have the features of
       OID-stored arguments. However, it is possible to update a
       database containing text-based <code class="literal">DEFAULT</code> clauses.
       First, save this query into a file, such as <code class="filename">fixseq.sql</code>:
</p>
<pre class="programlisting">SELECT  'ALTER TABLE ' ||
    pg_catalog.quote_ident(n.nspname) || '.' ||
    pg_catalog.quote_ident(c.relname) ||
    ' ALTER COLUMN ' || pg_catalog.quote_ident(a.attname) ||
    ' SET DEFAULT ' ||
    regexp_replace(d.adsrc,
                   $$val\(\(('[^']*')::text\)::regclass$$,
                   $$val(\1$$,
                   'g') ||
    ';'
FROM    pg_namespace n, pg_class c, pg_attribute a, pg_attrdef d
WHERE   n.oid = c.relnamespace AND
    c.oid = a.attrelid AND
    a.attrelid = d.adrelid AND
    a.attnum = d.adnum AND
    d.adsrc ~ $$val\(\('[^']*'::text\)::regclass$$;</pre>
<p>
       Next, run the query against a database to find what
       adjustments are required, like this for database <code class="literal">db1</code>:
</p>
<pre class="programlisting">psql -t -f fixseq.sql db1</pre>
<p>
       This will show the <code class="command">ALTER TABLE</code> commands needed to
       convert the database to the newer OID-based representation.
       If the commands look reasonable, run this to update the database:
</p>
<pre class="programlisting">psql -t -f fixseq.sql db1 | psql -e db1</pre>
<p>
       This process must be repeated in each database to be updated.
      </p>
</li>
<li>
<p>       In <span class="application">psql</span>, treat unquoted
       <code class="literal">\{digit}+</code> sequences as octal (Bruce)
      </p>
<p>       In previous releases, <code class="literal">\{digit}+</code> sequences were
       treated as decimal, and only <code class="literal">\0{digit}+</code> were treated
       as octal. This change was made for consistency.
      </p>
</li>
<li>
<p>       Remove grammar productions for prefix and postfix <code class="literal">%</code>
       and <code class="literal">^</code> operators
       (Tom)
      </p>
<p>       These have never been documented and complicated the use of the
       modulus operator (<code class="literal">%</code>) with negative numbers.
      </p>
</li>
<li><p>       Make <code class="literal">&amp;&lt;</code> and <code class="literal">&amp;&gt;</code> for polygons
       consistent with the box "over" operators (Tom)
      </p></li>
<li>
<p>       <code class="command">CREATE LANGUAGE</code> may ignore the provided arguments
       in favor of information from <code class="structname">pg_pltemplate</code>
       (Tom)
      </p>
<p>       A new system catalog <code class="structname">pg_pltemplate</code> has been defined
       to carry information about the preferred definitions of procedural
       languages (such as whether they have validator functions).  When
       an entry exists in this catalog for the language being created,
       <code class="command">CREATE LANGUAGE</code> will ignore all its parameters except the
       language name and instead use the catalog information.  This measure
       was taken because of increasing problems with obsolete language
       definitions being loaded by old dump files.  As of 8.1,
       <span class="application">pg_dump</span> will dump procedural language definitions as
       just <code class="command">CREATE LANGUAGE <em class="replaceable"><code>name</code></em></code>, relying
       on a template entry to exist at load time.  We expect this will be a
       more future-proof representation.
      </p>
</li>
<li><p>       Make <code class="function">pg_cancel_backend(int)</code> return a
       <code class="type">boolean</code> rather than an <code class="type">integer</code> (Neil)
      </p></li>
<li><p>       Some users are having problems loading UTF-8 data into 8.1.X.
       This is because previous versions allowed invalid UTF-8 byte
       sequences to be entered into the database, and this release
       properly accepts only valid UTF-8 sequences. One way to correct a
       dumpfile is to run the command <code class="command">iconv -c -f UTF-8 -t
       UTF-8 -o cleanfile.sql dumpfile.sql</code>. The <code class="literal">-c</code> option
       removes invalid character sequences. A diff of the two files will
       show the sequences that are invalid. <code class="command">iconv</code> reads the
       entire input file into memory so it might be necessary to use
       <span class="application">split</span> to break up the dump into multiple smaller
       files for processing.
      </p></li>
</ul></div>
</div>
<div class="sect2" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="id2834686"></a>E.8.3. Additional Changes</h3></div></div></div>
<p>     Below you will find a detailed account of the additional changes
     between <span class="productname">PostgreSQL</span> 8.1 and the
     previous major release.
    </p>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2834700"></a>E.8.3.1. Performance Improvements</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>        Improve GiST and R-tree index performance (Neil)
       </p></li>
<li><p>        Improve the optimizer, including auto-resizing of hash joins
        (Tom)
       </p></li>
<li><p>        Overhaul internal API in several areas
       </p></li>
<li>
<p>        Change WAL record CRCs from 64-bit to 32-bit (Tom)
       </p>
<p>        We determined that the extra cost of computing 64-bit CRCs was
        significant, and the gain in reliability too marginal to justify it.
       </p>
</li>
<li><p>        Prevent writing large empty gaps in WAL pages (Tom)
       </p></li>
<li><p>        Improve spinlock behavior on SMP machines, particularly Opterons (Tom)
       </p></li>
<li>
<p>        Allow nonconsecutive index columns to be used in a multicolumn
        index (Tom)
       </p>
<p>        For example, this allows an index on columns a,b,c to be used in
        a query with <code class="command">WHERE a = 4 and c = 10</code>.
       </p>
</li>
<li>
<p>        Skip WAL logging for <code class="command">CREATE TABLE AS</code> /
        <code class="command">SELECT INTO</code> (Simon)
       </p>
<p>        Since a crash during <code class="command">CREATE TABLE AS</code> would cause the
        table to be dropped during recovery, there is no reason to WAL
        log as the table is loaded.  (Logging still happens if WAL
        archiving is enabled, however.)
       </p>
</li>
<li><p>        Allow concurrent GiST index access (Teodor, Oleg)
       </p></li>
<li>
<p>        Add configuration parameter <code class="varname">full_page_writes</code> to
        control writing full pages to WAL (Bruce)
       </p>
<p>        To prevent partial disk writes from corrupting the database,
        <span class="productname">PostgreSQL</span> writes a complete copy of
        each database disk page to WAL the first time it is modified
        after a checkpoint. This option turns off that functionality for more
        speed.  This is safe to use with battery-backed disk caches where
        partial page writes cannot happen.
       </p>
</li>
<li>
<p>        Use <code class="literal">O_DIRECT</code> if available when using
        <code class="literal">O_SYNC</code> for <code class="varname">wal_sync_method</code>
        (Itagaki Takahiro)
       </p>
<p>        <code class="literal">O_DIRECT</code> causes disk writes to bypass the kernel
        cache, and for WAL writes, this improves performance.
       </p>
</li>
<li>
<p>        Improve <code class="command">COPY FROM</code> performance (Alon Goldshuv)
       </p>
<p>        This was accomplished by reading <code class="command">COPY</code> input in
        larger chunks, rather than character by character.
       </p>
</li>
<li><p>        Improve the performance of <code class="function">COUNT()</code>,
        <code class="function">SUM</code>, <code class="function">AVG()</code>,
        <code class="function">STDDEV()</code>, and
        <code class="function">VARIANCE()</code> (Neil, Tom)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2834892"></a>E.8.3.2. Server Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Prevent problems due to transaction ID (XID) wraparound (Tom)
       </p>
<p>        The server will now warn when the transaction counter approaches
        the wraparound point.  If the counter becomes too close to wraparound,
        the server will stop accepting queries.  This ensures that data is
        not lost before needed vacuuming is performed.
       </p>
</li>
<li><p>        Fix problems with object IDs (OIDs) conflicting with existing system
        objects after the OID counter has wrapped around (Tom)
       </p></li>
<li><p>        Add warning about the need to increase
        <code class="varname">max_fsm_relations</code> and <code class="varname">max_fsm_pages</code>
        during <code class="command">VACUUM</code> (Ron Mayer)
       </p></li>
<li><p>        Add <code class="varname">temp_buffers</code> configuration parameter to allow
        users to determine the size of the local buffer area for
        temporary table access (Tom)
       </p></li>
<li><p>        Add session start time and client IP address to
        <code class="literal">pg_stat_activity</code> (Magnus)
       </p></li>
<li>
<p>        Adjust <code class="literal">pg_stat</code> views for bitmap scans (Tom)
       </p>
<p>        The meanings of some of the fields have changed slightly.
       </p>
</li>
<li><p>        Enhance <code class="literal">pg_locks</code> view (Tom)
       </p></li>
<li><p>        Log queries for client-side <code class="command">PREPARE</code> and
        <code class="command">EXECUTE</code> (Simon)
       </p></li>
<li><p>        Allow Kerberos name and user name case sensitivity to be
        specified in <code class="filename">postgresql.conf</code> (Magnus)
       </p></li>
<li>
<p>        Add configuration parameter <code class="varname">krb_server_hostname</code> so
        that the server host name can be specified as part of service
        principal (Todd Kover)
       </p>
<p>        If not set, any service principal matching an entry in the
        keytab can be used. This is new Kerberos matching behavior in
        this release.
       </p>
</li>
<li><p>        Add <code class="varname">log_line_prefix</code> options for millisecond
        timestamps (<code class="literal">%m</code>) and remote host (<code class="literal">%h</code>) (Ed
        L.)
       </p></li>
<li>
<p>        Add WAL logging for GiST indexes (Teodor, Oleg)
       </p>
<p>        GiST indexes are now safe for crash and point-in-time recovery.
       </p>
</li>
<li>
<p>        Remove old <code class="filename">*.backup</code> files when we do
        <code class="function">pg_stop_backup()</code> (Bruce)
       </p>
<p>        This prevents a large number of <code class="filename">*.backup</code> files from
        existing in <code class="filename">pg_xlog/</code>.
       </p>
</li>
<li>
<p>        Add configuration parameters to control TCP/IP keep-alive
        times for idle, interval, and count (Oliver Jowett)
       </p>
<p>        These values can be changed to allow more rapid detection of
        lost client connections.
       </p>
</li>
<li>
<p>        Add per-user and per-database connection limits (Petr Jelinek)
       </p>
<p>        Using <code class="command">ALTER USER</code> and <code class="command">ALTER DATABASE</code>,
        limits can now be enforced on the maximum number of sessions that
        can concurrently connect as a specific user or to a specific database.
        Setting the limit to zero disables user or database connections.
       </p>
</li>
<li><p>        Allow more than two gigabytes of shared memory and per-backend
        work memory on 64-bit machines (Koichi Suzuki)
       </p></li>
<li><p>        New system catalog <code class="structname">pg_pltemplate</code> allows overriding
        obsolete procedural-language definitions in dump files (Tom)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2835125"></a>E.8.3.3. Query Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>        Add temporary views (Koju Iijima, Neil) 
       </p></li>
<li>
<p>        Fix <code class="command">HAVING</code> without any aggregate functions or
        <code class="command">GROUP BY</code> so that the query returns a single group (Tom)
       </p>
<p>        Previously, such a case would treat the <code class="command">HAVING</code>
        clause the same as a <code class="command">WHERE</code> clause.  This was not per spec.
       </p>
</li>
<li>
<p>        Add <code class="command">USING</code> clause to allow additional tables to be
        specified to <code class="command">DELETE</code> (Euler Taveira de Oliveira, Neil)
       </p>
<p>        In prior releases, there was no clear method for specifying
        additional tables to be used for joins in a <code class="command">DELETE</code>
        statement. <code class="command">UPDATE</code> already has a <code class="literal">FROM</code>
        clause for this purpose.
       </p>
</li>
<li>
<p>        Add support for <code class="literal">\x</code> hex escapes in backend and ecpg
        strings (Bruce)
       </p>
<p>        This is just like the standard C <code class="literal">\x</code> escape syntax.
        Octal escapes were already supported.
       </p>
</li>
<li>
<p>        Add <code class="command">BETWEEN SYMMETRIC</code> query syntax (Pavel Stehule)
       </p>
<p>        This feature allows <code class="command">BETWEEN</code> comparisons without
        requiring the first value to be less than the second. For
        example, <code class="command">2 BETWEEN [ASYMMETRIC] 3 AND 1</code> returns
        false, while <code class="command">2 BETWEEN SYMMETRIC 3 AND 1</code> returns
        true. <code class="command">BETWEEN ASYMMETRIC</code> was already supported.
       </p>
</li>
<li>
<p>        Add <code class="command">NOWAIT</code> option to <code class="command">SELECT ... FOR
        UPDATE/SHARE</code> (Hans-Juergen Schoenig)
       </p>
<p>        While the <code class="varname">statement_timeout</code> configuration
        parameter allows a query taking more than a certain amount of
        time to be cancelled, the <code class="command">NOWAIT</code> option allows a
        query to be canceled as soon as a <code class="command">SELECT ... FOR
        UPDATE/SHARE</code> command cannot immediately acquire a row lock.
       </p>
</li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2835306"></a>E.8.3.4. Object Manipulation Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Track dependencies of shared objects (Alvaro)
       </p>
<p>        <span class="productname">PostgreSQL</span> allows global tables
        (users, databases, tablespaces) to reference information in
        multiple databases. This addition adds dependency information
        for global tables, so, for example, user ownership can be
        tracked across databases, so a user who owns something in any
        database can no longer be removed. Dependency tracking already
        existed for database-local objects.
       </p>
</li>
<li>
<p>        Allow limited <code class="command">ALTER OWNER</code> commands to be performed 
        by the object owner (Stephen Frost)
       </p>
<p>        Prior releases allowed only superusers to change object owners.
        Now, ownership can be transferred if the user executing the command
        owns the object and would be able to create it as the new owner
        (that is, the user is a member of the new owning role and that role
        has the CREATE permission that would be needed to create the object
        afresh).
       </p>
</li>
<li>
<p>        Add <code class="command">ALTER</code> object <code class="command">SET SCHEMA</code> capability
        for some object types (tables, functions, types) (Bernd Helmle)
       </p>
<p>        This allows objects to be moved to different schemas.
       </p>
</li>
<li><p>        Add <code class="command">ALTER TABLE ENABLE/DISABLE TRIGGER</code> to
        disable triggers (Satoshi Nagayasu)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2835382"></a>E.8.3.5. Utility Command Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Allow <code class="command">TRUNCATE</code> to truncate multiple tables in a
        single command (Alvaro)
       </p>
<p>        Because of referential integrity checks, it is not allowed to
        truncate a table that is part of a referential integrity
        constraint. Using this new functionality, <code class="command">TRUNCATE</code>
        can be used to truncate such tables, if both tables involved in
        a referential integrity constraint are truncated in a single
        <code class="command">TRUNCATE</code> command.
       </p>
</li>
<li>
<p>        Properly process carriage returns and line feeds in
        <code class="command">COPY CSV</code> mode (Andrew)
       </p>
<p>        In release 8.0, carriage returns and line feeds in <code class="command">CSV
        COPY TO</code> were processed in an inconsistent manner. (This was
        documented on the TODO list.)
       </p>
</li>
<li>
<p>        Add <code class="command">COPY WITH CSV HEADER</code> to allow a header line as
        the first line in <code class="command">COPY</code> (Andrew)
       </p>
<p>        This allows handling of the common <code class="command">CSV</code> usage of
        placing the column names on the first line of the data file. For
        <code class="command">COPY TO</code>, the first line contains the column names,
        and for <code class="command">COPY FROM</code>, the first line is ignored.
       </p>
</li>
<li><p>        On Windows, display better sub-second precision in
        <code class="command">EXPLAIN ANALYZE</code> (Magnus)
       </p></li>
<li>
<p>        Add trigger duration display to <code class="command">EXPLAIN ANALYZE</code>
        (Tom)
       </p>
<p>        Prior releases included trigger execution time as part of the
        total execution time, but did not show it separately.  It is now
        possible to see how much time is spent in each trigger.
       </p>
</li>
<li>
<p>        Add support for <code class="literal">\x</code> hex escapes in <code class="command">COPY</code>
        (Sergey Ten)
       </p>
<p>        Previous releases only supported octal escapes.
       </p>
</li>
<li>
<p>        Make <code class="command">SHOW ALL</code> include variable descriptions
        (Matthias Schmidt)
       </p>
<p>        <code class="command">SHOW</code> varname still only displays the variable's
        value and does not include the description.
       </p>
</li>
<li>
<p>        Make <span class="application">initdb</span> create a new standard
        database called <code class="literal">postgres</code>, and convert utilities to
        use <code class="literal">postgres</code> rather than <code class="literal">template1</code> for
        standard lookups (Dave)
       </p>
<p>        In prior releases, <code class="literal">template1</code> was used both as a
        default connection for utilities like
        <span class="application">createuser</span>, and as a template for
        new databases. This caused <code class="command">CREATE DATABASE</code> to
        sometimes fail, because a new database cannot be created if
        anyone else is in the template database. With this change, the
        default connection database is now <code class="literal">postgres</code>,
        meaning it is much less likely someone will be using
        <code class="literal">template1</code> during <code class="command">CREATE DATABASE</code>.
       </p>
</li>
<li><p>        Create new <span class="application">reindexdb</span> command-line
        utility by moving <code class="filename">/contrib/reindexdb</code> into the
        server (Euler Taveira de Oliveira)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2835637"></a>E.8.3.6. Data Type and Function Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>        Add <code class="function">MAX()</code> and <code class="function">MIN()</code> aggregates for
        array types (Koju Iijima)
       </p></li>
<li>
<p>        Fix <code class="function">to_date()</code> and <code class="function">to_timestamp()</code> to
        behave reasonably when <code class="literal">CC</code> and <code class="literal">YY</code> fields
        are both used (Karel Zak)
       </p>
<p>        If the format specification contains <code class="literal">CC</code> and a year
        specification is <code class="literal">YYY</code> or longer, ignore the
        <code class="literal">CC</code>. If the year specification is <code class="literal">YY</code> or
        shorter, interpret <code class="literal">CC</code> as the previous century.
       </p>
</li>
<li>
<p>        Add <code class="function">md5(bytea)</code> (Abhijit Menon-Sen)
       </p>
<p>        <code class="function">md5(text)</code> already existed.
       </p>
</li>
<li>
<p>        Add support for <code class="command">numeric ^ numeric</code> based on
        <code class="function">power(numeric, numeric)</code>
       </p>
<p>        The function already existed, but there was no operator assigned
        to it.
       </p>
</li>
<li>
<p>        Fix <code class="type">NUMERIC</code> modulus by properly truncating the quotient
        during computation (Bruce)
       </p>
<p>        In previous releases, modulus for large values sometimes
        returned negative results due to rounding of the quotient.
       </p>
</li>
<li>
<p>        Add a function <code class="function">lastval()</code> (Dennis Björklund)
       </p>
<p>        <code class="function">lastval()</code> is a simplified version of
        <code class="function">currval()</code>. It automatically determines the proper
        sequence name based on the most recent <code class="function">nextval()</code> or
        <code class="function">setval()</code> call performed by the current session.
       </p>
</li>
<li>
<p>        Add <code class="function">to_timestamp(DOUBLE PRECISION) (Michael Glaesemann)</code>
       </p>
<p>        Converts Unix seconds since 1970 to a <code class="type">TIMESTAMP WITH
        TIMEZONE</code>.
       </p>
</li>
<li><p>        Add <code class="function">pg_postmaster_start_time()</code> function (Euler
        Taveira de Oliveira, Matthias Schmidt)
       </p></li>
<li>
<p>        Allow the full use of time zone names in <code class="command">AT TIME
        ZONE</code>, not just the short list previously available (Magnus)
       </p>
<p>        Previously, only a predefined list of time zone names were
        supported by <code class="command">AT TIME ZONE</code>. Now any supported time
        zone name can be used, e.g.:
        </p>
<pre class="programlisting">         SELECT CURRENT_TIMESTAMP AT TIME ZONE 'Europe/London';
        </pre>
<p>
        In the above query, the time zone used is adjusted based on the
        daylight saving time rules that were in effect on the supplied
        date.
       </p>
</li>
<li>
<p>        Add <code class="function">GREATEST()</code> and <code class="function">LEAST()</code> variadic
        functions (Pavel Stehule)
       </p>
<p>        These functions take a variable number of arguments and return
        the greatest or least value among the arguments.
       </p>
</li>
<li>
<p>        Add <code class="function">pg_column_size()</code> (Mark Kirkwood)
       </p>
<p>        This returns storage size of a column, which might be compressed.
       </p>
</li>
<li>
<p>        Add <code class="function">regexp_replace()</code> (Atsushi Ogawa)
       </p>
<p>        This allows regular expression replacement, like sed. An optional
        flag argument allows selection of global (replace all) and
        case-insensitive modes.
       </p>
</li>
<li>
<p>        Fix interval division and multiplication (Bruce)
       </p>
<p>        Previous versions sometimes returned unjustified results, like
        <code class="command">'4 months'::interval / 5</code> returning <code class="command">'1 mon
        -6 days'</code>.
       </p>
</li>
<li>
<p>        Fix roundoff behavior in timestamp, time, and interval output (Tom)
       </p>
<p>        This fixes some cases in which the seconds field would be shown as
        <code class="literal">60</code> instead of incrementing the higher-order fields.
       </p>
</li>
<li>
<p>        Add a separate day field to type <code class="type">interval</code> so a one day
        interval can be distinguished from a 24 hour interval (Michael
        Glaesemann)
       </p>
<p>        Days that contain a daylight saving time adjustment are not 24
        hours long, but typically 23 or 25 hours.  This change creates a
        conceptual distinction between intervals of &#8220;<span class="quote">so many days</span>&#8221;
        and intervals of &#8220;<span class="quote">so many hours</span>&#8221;.  Adding
        <code class="literal">1 day</code> to a timestamp now gives the same local time on
        the next day even if a daylight saving time adjustment occurs
        between, whereas adding <code class="literal">24 hours</code> will give a different
        local time when this happens.  For example, under US DST rules:
        </p>
<pre class="programlisting">         '2005-04-03 00:00:00-05' + '1 day' = '2005-04-04 00:00:00-04'
         '2005-04-03 00:00:00-05' + '24 hours' = '2005-04-04 01:00:00-04'
        </pre>
<p>
       </p>
</li>
<li>
<p>        Add <code class="function">justify_days()</code> and <code class="function">justify_hours()</code>
        (Michael Glaesemann)
       </p>
<p>        These functions, respectively, adjust days to an appropriate
        number of full months and days, and adjust hours to an
        appropriate number of full days and hours.
       </p>
</li>
<li>
<p>        Move <code class="filename">/contrib/dbsize</code> into the backend, and rename
        some of the functions (Dave Page, Andreas Pflug)
       </p>
<p>        </p>
<div class="itemizedlist"><ul type="circle">
<li><p>            <code class="function">pg_tablespace_size()</code>
          </p></li>
<li><p>           <code class="function">pg_database_size()</code>
          </p></li>
<li><p>           <code class="function">pg_relation_size()</code>
          </p></li>
<li><p>           <code class="function">pg_total_relation_size()</code>
          </p></li>
<li><p>           <code class="function">pg_size_pretty()</code>
          </p></li>
</ul></div>
<p>
       </p>
<p>        <code class="function">pg_total_relation_size()</code> includes indexes and TOAST
        tables.
       </p>
</li>
<li>
<p>        Add functions for read-only file access to the cluster directory
        (Dave Page, Andreas Pflug)
       </p>
<p>        </p>
<div class="itemizedlist"><ul type="circle">
<li><p>           <code class="function">pg_stat_file()</code>
          </p></li>
<li><p>           <code class="function">pg_read_file()</code>
          </p></li>
<li><p>           <code class="function">pg_ls_dir()</code>
          </p></li>
</ul></div>
<p>
       </p>
</li>
<li><p>        Add <code class="function">pg_reload_conf()</code> to force reloading of the
        configuration files (Dave Page, Andreas Pflug)
       </p></li>
<li><p>        Add <code class="function">pg_rotate_logfile()</code> to force rotation of the
        server log file (Dave Page, Andreas Pflug)
       </p></li>
<li><p>        Change <code class="literal">pg_stat_*</code> views to include TOAST tables (Tom)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2836166"></a>E.8.3.7. Encoding and Locale Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Rename some encodings to be more consistent and to follow
        international standards (Bruce)
       </p>
<p>        </p>
<div class="itemizedlist"><ul type="circle">
<li><p>           <code class="literal">UNICODE</code> is now <code class="literal">UTF8</code>
          </p></li>
<li><p>           <code class="literal">ALT</code> is now <code class="literal">WIN866</code>
          </p></li>
<li><p>           <code class="literal">WIN</code> is now <code class="literal">WIN1251</code>
          </p></li>
<li><p>          <code class="literal">TCVN</code> is now <code class="literal">WIN1258</code>
          </p></li>
</ul></div>
<p>
       </p>
<p>        The original names still work.
       </p>
</li>
<li><p>        Add support for <code class="literal">WIN1252</code> encoding (Roland Volkmann)
       </p></li>
<li>
<p>        Add support for four-byte <code class="literal">UTF8</code> characters (John
        Hansen)
       </p>
<p>        Previously only one, two, and three-byte <code class="literal">UTF8</code> characters
        were supported. This is particularly important for support for
        some Chinese character sets.
       </p>
</li>
<li><p>        Allow direct conversion between <code class="literal">EUC_JP</code> and
        <code class="literal">SJIS</code> to improve performance (Atsushi Ogawa)
       </p></li>
<li>
<p>        Allow the UTF8 encoding to work on Windows (Magnus)
       </p>
<p>        This is done by mapping UTF8 to the Windows-native UTF16 
        implementation.
       </p>
</li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2836299"></a>E.8.3.8. General Server-Side Language Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>        Fix <code class="command">ALTER LANGUAGE RENAME</code> (Sergey Yatskevich)
       </p></li>
<li><p>        Allow function characteristics, like strictness and volatility,
        to be modified via <code class="command">ALTER FUNCTION</code> (Neil)
       </p></li>
<li><p>        Increase the maximum number of function arguments to 100 (Tom)
       </p></li>
<li>
<p>        Allow SQL and PL/PgSQL functions to use <code class="command">OUT</code> and
        <code class="command">INOUT</code> parameters (Tom)
       </p>
<p>        <code class="command">OUT</code> is an alternate way for a function to return
        values. Instead of using <code class="command">RETURN</code>, values can be
        returned by assigning to parameters declared as <code class="command">OUT</code> or
        <code class="command">INOUT</code>.  This is notationally simpler in some cases,
        particularly so when multiple values need to be returned.
        While returning multiple values from a function
        was possible in previous releases, this greatly simplifies the
        process.  (The feature will be extended to other server-side
        languages in future releases.)
       </p>
</li>
<li>
<p>        Move language handler functions into the <code class="literal">pg_catalog</code> schema
       </p>
<p>        This makes it easier to drop the public schema if desired.
       </p>
</li>
<li><p>        Add <code class="function">SPI_getnspname()</code> to SPI (Neil)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2836404"></a>E.8.3.9. PL/PgSQL Server-Side Language Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Overhaul the memory management of PL/PgSQL functions (Neil)
       </p>
<p>        The parsetree of each function is now stored in a separate
        memory context. This allows this memory to be easily reclaimed
        when it is no longer needed.
       </p>
</li>
<li>
<p>        Check function syntax at <code class="command">CREATE FUNCTION</code> time,
        rather than at runtime (Neil)
       </p>
<p>        Previously, most syntax errors were reported only when the
        function was executed.
       </p>
</li>
<li><p>        Allow <code class="command">OPEN</code> to open non-<code class="command">SELECT</code> queries
        like <code class="command">EXPLAIN</code> and <code class="command">SHOW</code> (Tom)
       </p></li>
<li>
<p>        No longer require functions to issue a <code class="command">RETURN</code>
        statement (Tom)
       </p>
<p>        This is a byproduct of the newly added <code class="command">OUT</code> and
        <code class="command">INOUT</code> functionality.  <code class="command">RETURN</code> can
        be omitted when it is not needed to provide the function's
        return value.
       </p>
</li>
<li><p>        Add support for an optional <code class="command">INTO</code> clause to
        PL/PgSQL's <code class="command">EXECUTE</code> statement (Pavel Stehule, Neil)
       </p></li>
<li><p>        Make <code class="command">CREATE TABLE AS</code> set <code class="command">ROW_COUNT</code> (Tom)
       </p></li>
<li>
<p>        Define <code class="literal">SQLSTATE</code> and <code class="literal">SQLERRM</code> to return
        the <code class="literal">SQLSTATE</code> and error message of the current
        exception (Pavel Stehule, Neil)
       </p>
<p>        These variables are only defined inside exception blocks.
       </p>
</li>
<li><p>        Allow the parameters to the <code class="command">RAISE</code> statement to be
        expressions (Pavel Stehule, Neil)
       </p></li>
<li><p>        Add a loop <code class="command">CONTINUE</code> statement (Pavel Stehule, Neil)
       </p></li>
<li><p>        Allow block and loop labels (Pavel Stehule)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2836580"></a>E.8.3.10. PL/Perl Server-Side Language Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Allow large result sets to be returned efficiently (Abhijit
        Menon-Sen)
       </p>
<p>        This allows functions to use <code class="function">return_next()</code> to avoid
        building the entire result set in memory.
       </p>
</li>
<li>
<p>        Allow one-row-at-a-time retrieval of query results (Abhijit Menon-Sen)
       </p>
<p>        This allows functions to use <code class="function">spi_query()</code> and
        <code class="function">spi_fetchrow()</code> to avoid accumulating the entire
        result set in memory.
       </p>
</li>
<li><p>        Force PL/Perl to handle strings as <code class="literal">UTF8</code> if the
        server encoding is <code class="literal">UTF8</code> (David Kamholz)
       </p></li>
<li>
<p>        Add a validator function for PL/Perl (Andrew)
       </p>
<p>        This allows syntax errors to be reported at definition time,
        rather than execution time.
       </p>
</li>
<li>
<p>        Allow PL/Perl to return a Perl array when the function returns
        an array type (Andrew)
       </p>
<p>        This basically maps <span class="productname">PostgreSQL</span> arrays
        to Perl arrays.
       </p>
</li>
<li><p>        Allow Perl nonfatal warnings to generate <code class="command">NOTICE</code>
        messages (Andrew)
       </p></li>
<li><p>        Allow Perl's <code class="literal">strict</code> mode to be enabled (Andrew)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2836681"></a>E.8.3.11. <span class="application">psql</span> Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Add <code class="command">\set ON_ERROR_ROLLBACK</code> to allow statements in
        a transaction to error without affecting the rest of the
        transaction (Greg Sabino Mullane)
       </p>
<p>        This is basically implemented by wrapping every statement in a
        sub-transaction.
       </p>
</li>
<li>
<p>        Add support for <code class="literal">\x</code> hex strings in
        <span class="application">psql</span> variables (Bruce)
       </p>
<p>        Octal escapes were already supported.
       </p>
</li>
<li><p>        Add support for <code class="command">troff -ms</code> output format (Roger
        Leigh)
       </p></li>
<li>
<p>        Allow the history file location to be controlled by
        <code class="envar">HISTFILE</code> (Andreas Seltenreich)
       </p>
<p>        This allows configuration of per-database history storage.
       </p>
</li>
<li><p>        Prevent <code class="command">\x</code> (expanded mode) from affecting
        the output of <code class="command">\d tablename</code> (Neil)
       </p></li>
<li>
<p>        Add <code class="option">-L</code> option to <span class="application">psql</span> to
        log sessions (Lorne Sunley)
       </p>
<p>        This option was added because some operating systems do not have
        simple command-line activity logging functionality.
       </p>
</li>
<li><p>        Make <code class="command">\d</code> show the tablespaces of indexes (Qingqing
        Zhou)
       </p></li>
<li>
<p>        Allow <span class="application">psql</span> help (<code class="command">\h</code>) to
        make a best guess on the proper help information (Greg Sabino
        Mullane)
       </p>
<p>        This allows the user to just add <code class="command">\h</code> to the front of
        the syntax error query and get help on the supported syntax.
        Previously any additional query text beyond the command name
        had to be removed to use <code class="command">\h</code>.
       </p>
</li>
<li>
<p>        Add <code class="command">\pset numericlocale</code> to allow numbers to be
        output in a locale-aware format (Eugen Nedelcu)
       </p>
<p>        For example, using <code class="literal">C</code> locale <code class="literal">100000</code> would
        be output as <code class="literal">100,000.0</code> while a European locale might
        output this value as <code class="literal">100.000,0</code>.
       </p>
</li>
<li>
<p>        Make startup banner show both server version number and
        <span class="application">psql</span>'s version number, when they are different (Bruce)
       </p>
<p>        Also, a warning will be shown if the server and <span class="application">psql</span>
        are from different major releases.
       </p>
</li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2836887"></a>E.8.3.12. <span class="application">pg_dump</span> Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Add <code class="option">-n</code> / <code class="option">--schema</code> switch to 
        <span class="application">pg_restore</span> (Richard van den Berg)
       </p>
<p>        This allows just the objects in a specified schema to be restored.
       </p>
</li>
<li>
<p>        Allow <span class="application">pg_dump</span> to dump large objects even in 
        text mode (Tom)
       </p>
<p>        With this change, large objects are now always dumped; the former
        <code class="option">-b</code> switch is a no-op.
       </p>
</li>
<li><p>        Allow <span class="application">pg_dump</span> to dump a consistent snapshot of 
        large objects (Tom)
       </p></li>
<li><p>        Dump comments for large objects (Tom)
       </p></li>
<li>
<p>        Add <code class="option">--encoding</code> to <span class="application">pg_dump</span> 
        (Magnus Hagander)
       </p>
<p>        This allows a database to be dumped in an encoding that is
        different from the server's encoding. This is valuable when
        transferring the dump to a machine with a different encoding.
       </p>
</li>
<li>
<p>        Rely on <code class="structname">pg_pltemplate</code> for procedural languages (Tom)
       </p>
<p>        If the call handler for a procedural language is in the
        <code class="literal">pg_catalog</code> schema, <span class="application">pg_dump</span> does not
        dump the handler.  Instead, it dumps the language using just
        <code class="command">CREATE LANGUAGE <em class="replaceable"><code>name</code></em></code>,
        relying on the <code class="structname">pg_pltemplate</code> catalog to provide
        the language's creation parameters at load time.
       </p>
</li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2837009"></a>E.8.3.13. <span class="application">libpq</span> Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>        Add a <code class="envar">PGPASSFILE</code> environment variable to specify the
        password file's filename (Andrew)
       </p></li>
<li><p>        Add <code class="function">lo_create()</code>, that is similar to
        <code class="function">lo_creat()</code> but allows the OID of the large object
        to be specified (Tom)
       </p></li>
<li><p>        Make <span class="application">libpq</span> consistently return an error
        to the client application on <code class="function">malloc()</code>
        failure (Neil)
       </p></li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2837061"></a>E.8.3.14. Source Code Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li><p>        Fix <span class="application">pgxs</span> to support building against a relocated
        installation
       </p></li>
<li><p>        Add spinlock support for the Itanium processor using Intel
        compiler (Vikram Kalsi)
       </p></li>
<li><p>        Add Kerberos 5 support for Windows (Magnus)
       </p></li>
<li><p>        Add Chinese FAQ (laser@pgsqldb.com)
       </p></li>
<li><p>        Rename Rendezvous to Bonjour to match OS/X feature renaming
        (Bruce)
       </p></li>
<li><p>        Add support for <code class="literal">fsync_writethrough</code> on
        Darwin (Chris Campbell)
       </p></li>
<li><p>        Streamline the passing of information within the server, the
        optimizer, and the lock system (Tom)
       </p></li>
<li>
<p>        Allow <span class="application">pg_config</span> to be compiled using MSVC (Andrew)
       </p>
<p>        This is required to build DBD::Pg using <span class="application">MSVC</span>.
       </p>
</li>
<li>
<p>        Remove support for Kerberos V4 (Magnus)
       </p>
<p>        Kerberos 4 had security vulnerabilities and is no longer
        maintained.
       </p>
</li>
<li><p>        Code cleanups (Coverity static analysis performed by
        EnterpriseDB)
       </p></li>
<li><p>        Modify <code class="filename">postgresql.conf</code> to use documentation defaults
        <code class="literal">on</code>/<code class="literal">off</code> rather than
        <code class="literal">true</code>/<code class="literal">false</code> (Bruce)
       </p></li>
<li><p>        Enhance <span class="application">pg_config</span> to be able to report more
        build-time values (Tom)
       </p></li>
<li><p>        Allow <span class="application">libpq</span> to be built thread-safe
        on Windows (Dave Page)
       </p></li>
<li><p>        Allow IPv6 connections to be used on Windows (Andrew)
       </p></li>
<li><p>        Add Server Administration documentation about I/O subsystem
        reliability (Bruce)
       </p></li>
<li>
<p>        Move private declarations from <code class="filename">gist.h</code> to
        <code class="filename">gist_private.h</code> (Neil)
       </p>
<p>        In previous releases, <code class="filename">gist.h</code> contained both the
        public GiST API (intended for use by authors of GiST index
        implementations) as well as some private declarations used by
        the implementation of GiST itself. The latter have been moved
        to a separate file, <code class="filename">gist_private.h</code>. Most GiST
        index implementations should be unaffected.
       </p>
</li>
<li>
<p>        Overhaul GiST memory management (Neil)
       </p>
<p>        GiST methods are now always invoked in a short-lived memory
        context. Therefore, memory allocated via <code class="function">palloc()</code>
        will be reclaimed automatically, so GiST index implementations
        do not need to manually release allocated memory via
        <code class="function">pfree()</code>.
       </p>
</li>
</ul></div>
</div>
<div class="sect3" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="id2837266"></a>E.8.3.15. Contrib Changes</h4></div></div></div>
<div class="itemizedlist"><ul type="disc">
<li>
<p>        Add <code class="filename">/contrib/pg_buffercache</code> contrib module (Mark
        Kirkwood)
       </p>
<p>        This displays the contents of the buffer cache, for debugging and
        performance tuning purposes.
       </p>
</li>
<li><p>        Remove <code class="filename">/contrib/array</code> because it is obsolete (Tom)
       </p></li>
<li><p>        Clean up the <code class="filename">/contrib/lo</code> module (Tom)
       </p></li>
<li><p>        Move <code class="filename">/contrib/findoidjoins</code> to
        <code class="filename">/src/tools</code> (Tom)
       </p></li>
<li>
<p>        Remove the <code class="literal">&lt;&lt;</code>, <code class="literal">&gt;&gt;</code>,
        <code class="literal">&amp;&lt;</code>, and <code class="literal">&amp;&gt;</code> operators from
        <code class="filename">/contrib/cube</code>
       </p>
<p>        These operators were not useful.
       </p>
</li>
<li><p>        Improve <code class="filename">/contrib/btree_gist</code> (Janko Richter)
       </p></li>
<li>
<p>        Improve <code class="filename">/contrib/pgbench</code> (Tomoaki Sato, Tatsuo)
       </p>
<p>        There is now a facility for testing with SQL command scripts given
        by the user, instead of only a hard-wired command sequence.
       </p>
</li>
<li>
<p>        Improve <code class="filename">/contrib/pgcrypto</code> (Marko Kreen)
       </p>
<div class="itemizedlist"><ul type="circle">
<li>
<p>          Implementation of OpenPGP symmetric-key and public-key encryption
         </p>
<p>          Both RSA and Elgamal public-key algorithms are supported.
         </p>
</li>
<li><p>          Stand alone build: include SHA256/384/512 hashes, Fortuna PRNG
         </p></li>
<li><p>          OpenSSL build: support 3DES, use internal AES with OpenSSL &lt; 0.9.7
         </p></li>
<li>
<p>          Take build parameters (OpenSSL, zlib) from <code class="filename">configure</code> result
         </p>
<p>          There is no need to edit the <code class="filename">Makefile</code> anymore.
         </p>
</li>
<li><p>          Remove support for <code class="filename">libmhash</code> and <code class="filename">libmcrypt</code>
         </p></li>
</ul></div>
</li>
</ul></div>
</div>
</div>
</div></body>
</html>
