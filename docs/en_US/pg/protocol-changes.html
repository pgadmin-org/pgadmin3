<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Summary of Changes since Protocol 2.0</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"><LINK
REV="MADE"
HREF="mailto:pgsql-docs@postgresql.org"><LINK
REL="HOME"
TITLE="PostgreSQL 7.4beta3 Documentation"
HREF="index.html"><LINK
REL="UP"
TITLE="Frontend/Backend Protocol"
HREF="protocol.html"><LINK
REL="PREVIOUS"
TITLE="Error and Notice Message Fields"
HREF="protocol-error-fields.html"><LINK
REL="NEXT"
TITLE="Page Files"
HREF="page.html"><LINK
REL="STYLESHEET"
TYPE="text/css"
HREF="stylesheet.css"><META
NAME="creation"
CONTENT="2003-09-15T14:41:50"></HEAD
><BODY
CLASS="SECT1"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="5"
ALIGN="center"
VALIGN="bottom"
>PostgreSQL 7.4beta3 Documentation</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="protocol-error-fields.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="top"
><A
HREF="protocol.html"
>Fast Backward</A
></TD
><TD
WIDTH="60%"
ALIGN="center"
VALIGN="bottom"
>Chapter 45. Frontend/Backend Protocol</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="top"
><A
HREF="protocol.html"
>Fast Forward</A
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="top"
><A
HREF="page.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="PROTOCOL-CHANGES"
>45.6. Summary of Changes since Protocol 2.0</A
></H1
><P
>This section provides a quick checklist of changes, for the benefit of
developers trying to update existing client libraries to protocol 3.0.</P
><P
>The initial startup packet uses a flexible list-of-strings format
instead of a fixed format.  Notice that session default values for run-time
parameters can now be specified directly in the startup packet.  (Actually,
you could do that before using the <VAR
CLASS="LITERAL"
>options</VAR
> field, but given the
limited width of <VAR
CLASS="LITERAL"
>options</VAR
> and the lack of any way to quote
whitespace in the values, it wasn't a very safe technique.)</P
><P
>All messages now have a length count immediately following the message type
byte (except for startup packets, which have no type byte).  Also note that
PasswordMessage now has a type byte.</P
><P
>ErrorResponse and NoticeResponse ('<VAR
CLASS="LITERAL"
>E</VAR
>' and '<VAR
CLASS="LITERAL"
>N</VAR
>')
messages now contain multiple fields, from which the client code may
assemble an error message of the desired level of verbosity.  Note that
individual fields will typically not end with a newline, whereas the single
string sent in the older protocol always did.</P
><P
>The ReadyForQuery ('<VAR
CLASS="LITERAL"
>Z</VAR
>') message includes a transaction status
indicator.</P
><P
>The distinction between BinaryRow and DataRow message types is gone; the
single DataRow message type serves for returning data in all formats.
Note that the layout of DataRow has changed to make it easier to parse.
Also, the representation of binary values has changed: it is no longer
directly tied to the server's internal representation.</P
><P
>There is a new <SPAN
CLASS="QUOTE"
>"extended query"</SPAN
> sub-protocol, which adds the frontend
message types Parse, Bind, Execute, Describe, Close, Flush, and Sync, and the
backend message types ParseComplete, BindComplete, PortalSuspended,
ParameterDescription, NoData, and CloseComplete.  Existing clients do not
have to concern themselves with this sub-protocol, but making use of it
may allow improvements in performance or functionality.</P
><P
>COPY data is now encapsulated into CopyData and CopyDone messages.  There
is a well-defined way to recover from errors during COPY.  The special
<SPAN
CLASS="QUOTE"
>"<VAR
CLASS="LITERAL"
>\.</VAR
>"</SPAN
> last line is not needed anymore, and is not sent
during COPY OUT.
(It is still recognized as a terminator during COPY IN, but its use is
deprecated and will eventually be removed.)  Binary COPY is supported.
The CopyInResponse and CopyOutResponse messages include fields indicating
the number of columns and the format of each column.</P
><P
>The layout of FunctionCall and FunctionCallResponse messages has changed.
FunctionCall can now support passing NULL arguments to functions.  It also
can handle passing parameters and retrieving results in either text or
binary format.  There is no longer any reason to consider FunctionCall a
potential security hole, since it does not offer direct access to internal
server data representations.</P
><P
>The backend sends ParameterStatus ('<VAR
CLASS="LITERAL"
>S</VAR
>') messages during connection
startup for all parameters it considers interesting to the client library.
Subsequently, a ParameterStatus message is sent whenever the active value
changes for any of these parameters.</P
><P
>The RowDescription ('<VAR
CLASS="LITERAL"
>T</VAR
>') message carries new table OID and column
number fields for each column of the described row.  It also shows the format
code for each column.</P
><P
>The CursorResponse ('<VAR
CLASS="LITERAL"
>P</VAR
>') message is no longer generated by
the backend.</P
><P
>The NotificationResponse ('<VAR
CLASS="LITERAL"
>A</VAR
>') message has an additional string
field, which is presently empty but may someday carry additional data passed
from the NOTIFY event sender.</P
><P
>The EmptyQueryResponse ('<VAR
CLASS="LITERAL"
>I</VAR
>') message used to include an empty
string parameter; this has been removed.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="protocol-error-fields.html"
ACCESSKEY="P"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="page.html"
ACCESSKEY="N"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Error and Notice Message Fields</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="protocol.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Page Files</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>